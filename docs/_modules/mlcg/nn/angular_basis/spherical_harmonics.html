<!DOCTYPE html>
<html lang="en" data-accent-color="plum" data-content_root="../../../../">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"><title>mlcg.nn.angular_basis.spherical_harmonics - mlcg 0.1.3 documentation</title><link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><script>
    function setColorMode(t){let e=document.documentElement;e.setAttribute("data-color-mode",t);let a=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,s=t;"auto"===t&&(s=a?"dark":"light"),"light"===s?(e.classList.remove("dark"),e.classList.add("light")):(e.classList.remove("light"),e.classList.add("dark"))}
    setColorMode(localStorage._theme||"auto");
  </script><link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=31853864" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/shibuya.css?v=44020203" />
    <link media="print" rel="stylesheet" type="text/css" href="../../../../_static/print.css?v=20ff2c19" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --sy-f-text: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
  --sy-f-heading: "Inter", var(--sy-f-sys), var(--sy-f-cjk), sans-serif;
}
</style>
    <meta property="og:type" content="website"/><meta property="og:title" content="mlcg.nn.angular_basis.spherical_harmonics"/>
    <meta name="twitter:card" content="summary"/>
  </head>
<body><div class="sy-head">
  <div class="sy-head-blur"></div>
  <div class="sy-head-inner sy-container mx-auto">
    <a class="sy-head-brand" href="../../../../index.html">
      
      
      <strong>mlcg</strong>
    </a>
    <div class="sy-head-nav" id="head-nav">
      <nav class="sy-head-links"></nav>
      <div class="sy-head-extra flex items-center print:hidden"><form class="searchbox flex items-center" action="../../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <kbd>/</kbd>
</form><div class="sy-head-socials"></div></div>
    </div>
    <div class="sy-head-actions flex items-center shrink-0 print:hidden"><button class="js-theme theme-switch flex items-center"
data-aria-auto="Switch to light color mode"
data-aria-light="Switch to dark color mode"
data-aria-dark="Switch to auto color mode">
<i class="i-lucide theme-icon"></i>
</button><button class="md:hidden flex items-center js-menu" aria-label="Menu" type="button" aria-controls="head-nav" aria-expanded="false">
        <div class="hamburger">
          <span class="hamburger_1"></span>
          <span class="hamburger_2"></span>
          <span class="hamburger_3"></span>
        </div>
      </button>
    </div>
  </div>
</div>
<div class="sy-page sy-container flex mx-auto">
  <aside id="lside" class="sy-lside md:w-72 md:shrink-0 print:hidden">
    <div class="sy-lside-inner md:sticky">
      <div class="sy-scrollbar p-6">
        <div class="globaltoc" data-expand-depth="0"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../data/index.html">Data and datasets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../data/atom_data.html">Molecular Data Representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../data/fixed_datasets.html">Fixed datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../data/h5_datasets.html">H5 Dataset</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../geometry/index.html">Geometry and Neighbor lists</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../geometry/internal_coordinates.html">Internal Coordinate Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../geometry/neighbor_list.html">Neighbor Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../geometry/topology.html">Topology Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../geometry/statistics.html">Statistics Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../models/index.html">Model utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../models/priors.html">Priors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../models/cutoffs.html">Cutoff Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../models/rbfs.html">Radial Basis Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../models/mlip.html">MLIPs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../models/wrappers.html">Gradient/sum wrappers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../models/losses.html">Loss Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../training.html">Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../simulation/index.html">Simulations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../simulation/langevin.html">Langevin Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../simulation/overdamped.html">Overdamped Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../simulation/parallel_tempering.html">Parallel Tempering Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../simulation/utils.html">Simulation utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../misc/index.html">Miscellaneous utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../misc/coarse_graining.html">Coarse Graining</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../misc/utils.html">General utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../misc/mol_utils.html">Molecular utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dev/index.html">Developer Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../dev/doc.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../dev/tests.html">Tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../bibliography.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </div>
  </aside>
  <div class="lside-overlay js-menu" role="button" aria-label="Close left sidebar" aria-controls="lside" aria-expanded="false"></div>
  <aside id="rside" class="sy-rside pb-3 w-64 shrink-0 order-last">
    <button class="rside-close js-menu xl:hidden" aria-label="Close Table of Contents" type="button" aria-controls="rside" aria-expanded="false">
      <i class="i-lucide close"></i>
    </button>
    <div class="sy-scrollbar sy-rside-inner px-6 xl:top-16 xl:sticky xl:pl-0 pt-6 pb-4"><div id="ethical-ad-placement" data-ea-publisher="readthedocs"></div></div>
  </aside>
  <div class="rside-overlay js-menu" role="button" aria-label="Close Table of Contents" aria-controls="rside" aria-expanded="false"></div>
  <main class="sy-main w-full max-sm:max-w-full print:pt-6">
<div class="sy-breadcrumbs" role="navigation">
  <div class="sy-breadcrumbs-inner flex items-center">
    <div class="md:hidden mr-3">
      <button class="js-menu" aria-label="Menu" type="button" aria-controls="lside" aria-expanded="false">
        <i class="i-lucide menu"></i>
      </button>
    </div>
    <ol class="flex-1" itemscope itemtype="https://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="../../../../index.html"><span itemprop="name">mlcg</span></a>
        <span>/</span>
        <meta itemprop="position" content="1" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="../../../index.html"><span itemprop="name">Module code</span></a>
        <span>/</span>
        <meta itemprop="position" content="2" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <strong itemprop="name">mlcg.nn.angular_basis.spherical_harmonics</strong>
        <meta itemprop="position" content="3" />
      </li></ol>
    <div class="xl:hidden ml-1">
      <button class="js-menu" aria-label="Show table of contents" type="button" aria-controls="rside"
        aria-expanded="false">
        <i class="i-lucide outdent"></i>
      </button>
    </div>
  </div>
</div><div class="flex flex-col break-words justify-between">
      <div class="relative min-w-0 max-w-6xl px-6 pb-6 pt-8 xl:px-12">
  <article class="yue" role="main">
          <h1>Source code for mlcg.nn.angular_basis.spherical_harmonics</h1><div class="highlight"><pre>
<span></span><span data-line="1"><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Spherical Harmonics as polynomials of x, y, z</span>
</span><span data-line="2"><span class="sd">taken from the e3nn repo changing the layout of the output sph</span>
</span><span data-line="3"><span class="sd">(https://github.com/e3nn/e3nn/tree/34ebae91b094392a9f26dfa153f9350d0e24d185)</span>
</span><span data-line="4"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="5">
</span><span data-line="6"><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Union</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Any</span>
</span><span data-line="7">
</span><span data-line="8"><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
</span><span data-line="9">
</span><span data-line="10"><span class="kn">import</span><span class="w"> </span><span class="nn">sympy</span>
</span><span data-line="11"><span class="kn">from</span><span class="w"> </span><span class="nn">sympy.printing.pycode</span><span class="w"> </span><span class="kn">import</span> <span class="n">pycode</span>
</span><span data-line="12"><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
</span><span data-line="13">
</span><span data-line="14"><span class="kn">from</span><span class="w"> </span><span class="nn">e3nn</span><span class="w"> </span><span class="kn">import</span> <span class="n">o3</span>
</span><span data-line="15"><span class="kn">from</span><span class="w"> </span><span class="nn">e3nn.util.jit</span><span class="w"> </span><span class="kn">import</span> <span class="n">compile_mode</span>
</span><span data-line="16">
</span><span data-line="17"><span class="kn">from</span><span class="w"> </span><span class="nn">...geometry.internal_coordinates</span><span class="w"> </span><span class="kn">import</span> <span class="n">safe_norm</span><span class="p">,</span> <span class="n">safe_normalization</span>
</span><span data-line="18">
</span><span data-line="19">
<div class="viewcode-block" id="SphericalHarmonics">
<a class="viewcode-back" href="../../../../models/rbfs.html#mlcg.nn.angular_basis.spherical_harmonics.SphericalHarmonics">[docs]</a>
</span><span data-line="20"><span class="nd">@compile_mode</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">)</span>
</span><span data-line="21"><span class="k">class</span><span class="w"> </span><span class="nc">SphericalHarmonics</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
</span><span data-line="22"><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;JITable module version of real Spherical harmonics</span>
</span><span data-line="23">
</span><span data-line="24"><span class="sd">    .. image:: https://user-images.githubusercontent.com/333780/79220728-dbe82c00-7e54-11ea-82c7-b3acbd9b2246.gif</span>
</span><span data-line="25">
</span><span data-line="26"><span class="sd">    | Polynomials defined on the 3d space :math:`Y^l: \mathbb{R}^3 \longrightarrow \mathbb{R}^{2l+1}`</span>
</span><span data-line="27"><span class="sd">    | Usually restricted on the sphere (with ``normalize=True``) :math:`Y^l: S^2 \longrightarrow \mathbb{R}^{2l+1}`</span>
</span><span data-line="28"><span class="sd">    | who satisfies the following properties:</span>
</span><span data-line="29">
</span><span data-line="30"><span class="sd">    * are polynomials of the cartesian coordinates ``x, y, z``</span>
</span><span data-line="31"><span class="sd">    * is equivariant :math:`Y^l(R x) = D^l(R) Y^l(x)`</span>
</span><span data-line="32"><span class="sd">    * are orthogonal :math:`\int_{S^2} Y^l_m(x) Y^j_n(x) dx = \text{cste} \; \delta_{lj} \delta_{mn}`</span>
</span><span data-line="33">
</span><span data-line="34"><span class="sd">    The value of the constant depends on the choice of normalization.</span>
</span><span data-line="35">
</span><span data-line="36"><span class="sd">    It obeys the following property:</span>
</span><span data-line="37">
</span><span data-line="38"><span class="sd">    .. math::</span>
</span><span data-line="39">
</span><span data-line="40"><span class="sd">        Y^{l+1}_i(x) &amp;= \text{cste}(l) \; &amp; C_{ijk} Y^l_j(x) x_k</span>
</span><span data-line="41">
</span><span data-line="42"><span class="sd">        \partial_k Y^{l+1}_i(x) &amp;= \text{cste}(l) \; (l+1) &amp; C_{ijk} Y^l_j(x)</span>
</span><span data-line="43">
</span><span data-line="44"><span class="sd">    Where :math:`C` are the `Wigner 3-j symbols &lt;https://en.wikipedia.org/wiki/3-j_symbol&gt;`_.</span>
</span><span data-line="45">
</span><span data-line="46"><span class="sd">    .. note::</span>
</span><span data-line="47">
</span><span data-line="48"><span class="sd">        This function matches with the following table of standard real spherical harmonics from Wikipedia_</span>
</span><span data-line="49"><span class="sd">        when ``normalize=True``, ``normalization=&#39;integral&#39;`` and is called with the argument in the order ``y,z,x`` (instead of ``x,y,z``).</span>
</span><span data-line="50">
</span><span data-line="51"><span class="sd">    .. _Wikipedia: https://en.wikipedia.org/wiki/Table_of_spherical_harmonics#Real_spherical_harmonics</span>
</span><span data-line="52">
</span><span data-line="53"><span class="sd">    Parameters</span>
</span><span data-line="54"><span class="sd">    ----------</span>
</span><span data-line="55"><span class="sd">    l : int or list of int</span>
</span><span data-line="56"><span class="sd">        degree of the spherical harmonics.</span>
</span><span data-line="57">
</span><span data-line="58"><span class="sd">    x : `torch.Tensor`</span>
</span><span data-line="59"><span class="sd">        tensor :math:`x` of shape ``(..., 3)``.</span>
</span><span data-line="60">
</span><span data-line="61"><span class="sd">    normalize : bool</span>
</span><span data-line="62"><span class="sd">        whether to normalize the ``x`` to vectors that lie on the unit sphere before projecting onto the spherical harmonics</span>
</span><span data-line="63">
</span><span data-line="64"><span class="sd">    normalization : {&#39;integral&#39;, &#39;component&#39;, &#39;norm&#39;}</span>
</span><span data-line="65"><span class="sd">        normalization of the output tensors --- note that this option is independent of ``normalize``, which controls the processing of the *input*, rather than the output.</span>
</span><span data-line="66"><span class="sd">        Valid options:</span>
</span><span data-line="67"><span class="sd">        * *component*: :math:`\|Y^l(x)\|^2 = 2l+1, x \in S^2`</span>
</span><span data-line="68"><span class="sd">        * *norm*: :math:`\|Y^l(x)\| = 1, x \in S^2`, ``component / sqrt(2l+1)``</span>
</span><span data-line="69"><span class="sd">        * *integral*: :math:`\int_{S^2} Y^l_m(x)^2 dx = 1`, ``component / sqrt(4pi)``</span>
</span><span data-line="70">
</span><span data-line="71"><span class="sd">    Returns</span>
</span><span data-line="72"><span class="sd">    -------</span>
</span><span data-line="73">
</span><span data-line="74"><span class="sd">    List[torch.Tensor]</span>
</span><span data-line="75"><span class="sd">        a list of tensors of shapes ``[lmax][n_neighbor, m]`` where :math:`m&lt;=l`</span>
</span><span data-line="76">
</span><span data-line="77"><span class="sd">        .. math:: Y^l(x)</span>
</span><span data-line="78">
</span><span data-line="79">
</span><span data-line="80"><span class="sd">    &quot;&quot;&quot;</span>
</span><span data-line="81">
</span><span data-line="82">    <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span>
</span><span data-line="83">    <span class="n">normalization</span><span class="p">:</span> <span class="nb">str</span>
</span><span data-line="84">    <span class="n">_ls_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</span><span data-line="85">    <span class="n">_lmax</span><span class="p">:</span> <span class="nb">int</span>
</span><span data-line="86">
</span><span data-line="87">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
</span><span data-line="88">        <span class="bp">self</span><span class="p">,</span>
</span><span data-line="89">        <span class="n">lmax</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span data-line="90">        <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span data-line="91">        <span class="n">normalization</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;integral&quot;</span><span class="p">,</span>
</span><span data-line="92">        <span class="n">irreps_in</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="93">    <span class="p">):</span>
</span><span data-line="94">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span data-line="95">        <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span> <span class="o">=</span> <span class="n">normalize</span>
</span><span data-line="96">        <span class="bp">self</span><span class="o">.</span><span class="n">normalization</span> <span class="o">=</span> <span class="n">normalization</span>
</span><span data-line="97">        <span class="k">assert</span> <span class="n">normalization</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;integral&quot;</span><span class="p">,</span> <span class="s2">&quot;component&quot;</span><span class="p">,</span> <span class="s2">&quot;norm&quot;</span><span class="p">]</span>
</span><span data-line="98">        <span class="bp">self</span><span class="o">.</span><span class="n">_lmax</span> <span class="o">=</span> <span class="n">lmax</span>
</span><span data-line="99">        <span class="n">irreps_out</span> <span class="o">=</span> <span class="n">o3</span><span class="o">.</span><span class="n">Irreps</span><span class="o">.</span><span class="n">spherical_harmonics</span><span class="p">(</span><span class="n">lmax</span><span class="o">=</span><span class="n">lmax</span><span class="p">)</span>
</span><span data-line="100">
</span><span data-line="101">        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">irreps_out</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span data-line="102">            <span class="n">irreps_out</span> <span class="o">=</span> <span class="n">o3</span><span class="o">.</span><span class="n">Irreps</span><span class="p">(</span><span class="n">irreps_out</span><span class="p">)</span>
</span><span data-line="103">        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">irreps_out</span><span class="p">,</span> <span class="n">o3</span><span class="o">.</span><span class="n">Irreps</span><span class="p">)</span> <span class="ow">and</span> <span class="n">irreps_in</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="104">            <span class="k">for</span> <span class="n">mul</span><span class="p">,</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="ow">in</span> <span class="n">irreps_out</span><span class="p">:</span>
</span><span data-line="105">                <span class="k">if</span> <span class="n">l</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">p</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span data-line="106">                    <span class="n">irreps_in</span> <span class="o">=</span> <span class="n">o3</span><span class="o">.</span><span class="n">Irreps</span><span class="p">(</span><span class="s2">&quot;1e&quot;</span><span class="p">)</span>
</span><span data-line="107">        <span class="k">if</span> <span class="n">irreps_in</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="108">            <span class="n">irreps_in</span> <span class="o">=</span> <span class="n">o3</span><span class="o">.</span><span class="n">Irreps</span><span class="p">(</span><span class="s2">&quot;1o&quot;</span><span class="p">)</span>
</span><span data-line="109">
</span><span data-line="110">        <span class="n">irreps_in</span> <span class="o">=</span> <span class="n">o3</span><span class="o">.</span><span class="n">Irreps</span><span class="p">(</span><span class="n">irreps_in</span><span class="p">)</span>
</span><span data-line="111">        <span class="k">if</span> <span class="n">irreps_in</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="n">o3</span><span class="o">.</span><span class="n">Irreps</span><span class="p">(</span><span class="s2">&quot;1x1o&quot;</span><span class="p">),</span> <span class="n">o3</span><span class="o">.</span><span class="n">Irreps</span><span class="p">(</span><span class="s2">&quot;1x1e&quot;</span><span class="p">)):</span>
</span><span data-line="112">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span data-line="113">                <span class="sa">f</span><span class="s2">&quot;irreps_in for SphericalHarmonics must be either a vector (`1x1o`) or a pseudovector (`1x1e`), not `</span><span class="si">{</span><span class="n">irreps_in</span><span class="si">}</span><span class="s2">`&quot;</span>
</span><span data-line="114">            <span class="p">)</span>
</span><span data-line="115">        <span class="bp">self</span><span class="o">.</span><span class="n">irreps_in</span> <span class="o">=</span> <span class="n">irreps_in</span>
</span><span data-line="116">        <span class="n">input_p</span> <span class="o">=</span> <span class="n">irreps_in</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ir</span><span class="o">.</span><span class="n">p</span>
</span><span data-line="117">
</span><span data-line="118">        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">irreps_out</span><span class="p">,</span> <span class="n">o3</span><span class="o">.</span><span class="n">Irreps</span><span class="p">):</span>
</span><span data-line="119">            <span class="n">ls</span> <span class="o">=</span> <span class="p">[]</span>
</span><span data-line="120">            <span class="k">for</span> <span class="n">mul</span><span class="p">,</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="ow">in</span> <span class="n">irreps_out</span><span class="p">:</span>
</span><span data-line="121">                <span class="k">if</span> <span class="n">p</span> <span class="o">!=</span> <span class="n">input_p</span><span class="o">**</span><span class="n">l</span><span class="p">:</span>
</span><span data-line="122">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span data-line="123">                        <span class="sa">f</span><span class="s2">&quot;irreps_out `</span><span class="si">{</span><span class="n">irreps_out</span><span class="si">}</span><span class="s2">` passed to SphericalHarmonics asked for an output of l = </span><span class="si">{</span><span class="n">l</span><span class="si">}</span><span class="s2"> with parity p = </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">, which is inconsistent with the input parity </span><span class="si">{</span><span class="n">input_p</span><span class="si">}</span><span class="s2"> â€” the output parity should have been p = </span><span class="si">{</span><span class="n">input_p</span><span class="o">**</span><span class="n">l</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span data-line="124">                    <span class="p">)</span>
</span><span data-line="125">                <span class="n">ls</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">l</span><span class="p">]</span> <span class="o">*</span> <span class="n">mul</span><span class="p">)</span>
</span><span data-line="126">        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">irreps_out</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
</span><span data-line="127">            <span class="n">ls</span> <span class="o">=</span> <span class="p">[</span><span class="n">irreps_out</span><span class="p">]</span>
</span><span data-line="128">        <span class="k">else</span><span class="p">:</span>
</span><span data-line="129">            <span class="n">ls</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">irreps_out</span><span class="p">)</span>
</span><span data-line="130">
</span><span data-line="131">        <span class="n">irreps_out</span> <span class="o">=</span> <span class="n">o3</span><span class="o">.</span><span class="n">Irreps</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">input_p</span><span class="o">**</span><span class="n">l</span><span class="p">))</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">ls</span><span class="p">])</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
</span><span data-line="132">        <span class="bp">self</span><span class="o">.</span><span class="n">irreps_out</span> <span class="o">=</span> <span class="n">irreps_out</span>
</span><span data-line="133">        <span class="bp">self</span><span class="o">.</span><span class="n">_ls_list</span> <span class="o">=</span> <span class="n">ls</span>
</span><span data-line="134">
</span><span data-line="135">        <span class="n">_lmax</span> <span class="o">=</span> <span class="mi">11</span>
</span><span data-line="136">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lmax</span> <span class="o">&gt;</span> <span class="n">_lmax</span><span class="p">:</span>
</span><span data-line="137">            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
</span><span data-line="138">                <span class="sa">f</span><span class="s2">&quot;spherical_harmonics maximum l implemented is </span><span class="si">{</span><span class="n">_lmax</span><span class="si">}</span><span class="s2">, send us an email to ask for more&quot;</span>
</span><span data-line="139">            <span class="p">)</span>
</span><span data-line="140">
<div class="viewcode-block" id="SphericalHarmonics.forward">
<a class="viewcode-back" href="../../../../autodoc.html#mlcg.nn.angular_basis.spherical_harmonics.SphericalHarmonics.forward">[docs]</a>
</span><span data-line="141">    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
</span><span data-line="142">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="p">:</span>
</span><span data-line="143">            <span class="n">norms</span> <span class="o">=</span> <span class="n">safe_norm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span data-line="144">            <span class="n">x</span> <span class="o">=</span> <span class="n">safe_normalization</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norms</span><span class="p">)</span>
</span><span data-line="145">
</span><span data-line="146">        <span class="n">sh</span> <span class="o">=</span> <span class="n">_spherical_harmonics</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lmax</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</span><span data-line="147">
</span><span data-line="148">        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalization</span> <span class="o">==</span> <span class="s2">&quot;integral&quot;</span><span class="p">:</span>
</span><span data-line="149">            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ls_list</span><span class="p">):</span>
</span><span data-line="150">                <span class="n">sh</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">mul_</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
</span><span data-line="151">
</span><span data-line="152">        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalization</span> <span class="o">==</span> <span class="s2">&quot;component&quot;</span><span class="p">:</span>
</span><span data-line="153">            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ls_list</span><span class="p">):</span>
</span><span data-line="154">                <span class="n">sh</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">.</span><span class="n">mul_</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span data-line="155">
</span><span data-line="156">        <span class="k">return</span> <span class="n">sh</span></div>
</div>

</span><span data-line="157">
</span><span data-line="158">
</span><span data-line="159"><span class="nd">@torch</span><span class="o">.</span><span class="n">jit</span><span class="o">.</span><span class="n">script</span>
</span><span data-line="160"><span class="k">def</span><span class="w"> </span><span class="nf">_spherical_harmonics</span><span class="p">(</span>
</span><span data-line="161">    <span class="n">lmax</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span>
</span><span data-line="162"><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
</span><span data-line="163"><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the spherical harmonics up to lmax (included) from the cartesian</span>
</span><span data-line="164"><span class="sd">    positions `x,y,z` that should correspond to normalized vectors (direction</span>
</span><span data-line="165"><span class="sd">    vectors). This function uses explicit recursion formulas that were generated</span>
</span><span data-line="166"><span class="sd">    unsing the :func:`_generate_spherical_harmonics` function (defined below).</span>
</span><span data-line="167">
</span><span data-line="168"><span class="sd">    Parameters</span>
</span><span data-line="169"><span class="sd">    ----------</span>
</span><span data-line="170"><span class="sd">    lmax : int</span>
</span><span data-line="171"><span class="sd">        maximum order of the spherical harmonics (lmax is included)</span>
</span><span data-line="172"><span class="sd">    x : torch.Tensor</span>
</span><span data-line="173">
</span><span data-line="174"><span class="sd">    y : torch.Tensor</span>
</span><span data-line="175">
</span><span data-line="176"><span class="sd">    z : torch.Tensor</span>
</span><span data-line="177">
</span><span data-line="178">
</span><span data-line="179"><span class="sd">    Returns</span>
</span><span data-line="180"><span class="sd">    -------</span>
</span><span data-line="181"><span class="sd">    List[torch.Tensor]</span>
</span><span data-line="182"><span class="sd">        direction vectors expanded on the spherical harmonic basis of shape</span>
</span><span data-line="183"><span class="sd">        :math:`[l_max+1][n_vectors, m]`</span>
</span><span data-line="184"><span class="sd">    &quot;&quot;&quot;</span>
</span><span data-line="185">    <span class="n">sh_0_0</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span data-line="186">    <span class="n">out</span> <span class="o">=</span> <span class="p">[</span>
</span><span data-line="187">        <span class="n">sh_0_0</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
</span><span data-line="188">    <span class="p">]</span>
</span><span data-line="189">    <span class="k">if</span> <span class="n">lmax</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span data-line="190">        <span class="k">return</span> <span class="n">out</span>
</span><span data-line="191">
</span><span data-line="192">    <span class="n">sh_1_0</span> <span class="o">=</span> <span class="n">x</span>
</span><span data-line="193">    <span class="n">sh_1_1</span> <span class="o">=</span> <span class="n">y</span>
</span><span data-line="194">    <span class="n">sh_1_2</span> <span class="o">=</span> <span class="n">z</span>
</span><span data-line="195">    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">sh_1_0</span><span class="p">,</span> <span class="n">sh_1_1</span><span class="p">,</span> <span class="n">sh_1_2</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>
</span><span data-line="196">    <span class="k">if</span> <span class="n">lmax</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span data-line="197">        <span class="k">return</span> <span class="n">out</span>
</span><span data-line="198">
</span><span data-line="199">    <span class="n">sh_2_0</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="200">    <span class="n">sh_2_1</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="201">    <span class="n">y2</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span data-line="202">    <span class="n">x2z2</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">z</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span data-line="203">    <span class="n">sh_2_2</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">x2z2</span>
</span><span data-line="204">    <span class="n">sh_2_3</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="205">    <span class="n">sh_2_4</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</span><span data-line="206">
</span><span data-line="207">    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">sh_2_0</span><span class="p">,</span> <span class="n">sh_2_1</span><span class="p">,</span> <span class="n">sh_2_2</span><span class="p">,</span> <span class="n">sh_2_3</span><span class="p">,</span> <span class="n">sh_2_4</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>
</span><span data-line="208">    <span class="k">if</span> <span class="n">lmax</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span data-line="209">        <span class="k">return</span> <span class="n">out</span>
</span><span data-line="210">
</span><span data-line="211">    <span class="n">sh_3_0</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">5.0</span> <span class="o">/</span> <span class="mf">6.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">sh_2_0</span> <span class="o">*</span> <span class="n">z</span> <span class="o">+</span> <span class="n">sh_2_4</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
</span><span data-line="212">    <span class="n">sh_3_1</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">sh_2_0</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="213">    <span class="n">sh_3_2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">/</span> <span class="mf">8.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">x2z2</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="214">    <span class="n">sh_3_3</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">y2</span> <span class="o">-</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">x2z2</span><span class="p">)</span>
</span><span data-line="215">    <span class="n">sh_3_4</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.0</span> <span class="o">/</span> <span class="mf">8.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">z</span> <span class="o">*</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">x2z2</span><span class="p">)</span>
</span><span data-line="216">    <span class="n">sh_3_5</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">sh_2_4</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="217">    <span class="n">sh_3_6</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">5.0</span> <span class="o">/</span> <span class="mf">6.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">sh_2_4</span> <span class="o">*</span> <span class="n">z</span> <span class="o">-</span> <span class="n">sh_2_0</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
</span><span data-line="218">    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span data-line="219">        <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
</span><span data-line="220">            <span class="p">[</span><span class="n">sh_3_0</span><span class="p">,</span> <span class="n">sh_3_1</span><span class="p">,</span> <span class="n">sh_3_2</span><span class="p">,</span> <span class="n">sh_3_3</span><span class="p">,</span> <span class="n">sh_3_4</span><span class="p">,</span> <span class="n">sh_3_5</span><span class="p">,</span> <span class="n">sh_3_6</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span>
</span><span data-line="221">        <span class="p">)</span>
</span><span data-line="222">    <span class="p">)</span>
</span><span data-line="223">    <span class="k">if</span> <span class="n">lmax</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span data-line="224">        <span class="k">return</span> <span class="n">out</span>
</span><span data-line="225">
</span><span data-line="226">    <span class="n">sh_4_0</span> <span class="o">=</span> <span class="mf">0.935414346693485</span> <span class="o">*</span> <span class="n">sh_3_0</span> <span class="o">*</span> <span class="n">z</span> <span class="o">+</span> <span class="mf">0.935414346693485</span> <span class="o">*</span> <span class="n">sh_3_6</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="227">    <span class="n">sh_4_1</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="228">        <span class="mf">0.661437827766148</span> <span class="o">*</span> <span class="n">sh_3_0</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="229">        <span class="o">+</span> <span class="mf">0.810092587300982</span> <span class="o">*</span> <span class="n">sh_3_1</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="230">        <span class="o">+</span> <span class="mf">0.810092587300983</span> <span class="o">*</span> <span class="n">sh_3_5</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="231">    <span class="p">)</span>
</span><span data-line="232">    <span class="n">sh_4_2</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="233">        <span class="o">-</span><span class="mf">0.176776695296637</span> <span class="o">*</span> <span class="n">sh_3_0</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="234">        <span class="o">+</span> <span class="mf">0.866025403784439</span> <span class="o">*</span> <span class="n">sh_3_1</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="235">        <span class="o">+</span> <span class="mf">0.684653196881458</span> <span class="o">*</span> <span class="n">sh_3_2</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="236">        <span class="o">+</span> <span class="mf">0.684653196881457</span> <span class="o">*</span> <span class="n">sh_3_4</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="237">        <span class="o">+</span> <span class="mf">0.176776695296637</span> <span class="o">*</span> <span class="n">sh_3_6</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="238">    <span class="p">)</span>
</span><span data-line="239">    <span class="n">sh_4_3</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="240">        <span class="o">-</span><span class="mf">0.306186217847897</span> <span class="o">*</span> <span class="n">sh_3_1</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="241">        <span class="o">+</span> <span class="mf">0.968245836551855</span> <span class="o">*</span> <span class="n">sh_3_2</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="242">        <span class="o">+</span> <span class="mf">0.790569415042095</span> <span class="o">*</span> <span class="n">sh_3_3</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="243">        <span class="o">+</span> <span class="mf">0.306186217847897</span> <span class="o">*</span> <span class="n">sh_3_5</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="244">    <span class="p">)</span>
</span><span data-line="245">    <span class="n">sh_4_4</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="246">        <span class="o">-</span><span class="mf">0.612372435695795</span> <span class="o">*</span> <span class="n">sh_3_2</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="247">        <span class="o">+</span> <span class="n">sh_3_3</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="248">        <span class="o">-</span> <span class="mf">0.612372435695795</span> <span class="o">*</span> <span class="n">sh_3_4</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="249">    <span class="p">)</span>
</span><span data-line="250">    <span class="n">sh_4_5</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="251">        <span class="o">-</span><span class="mf">0.306186217847897</span> <span class="o">*</span> <span class="n">sh_3_1</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="252">        <span class="o">+</span> <span class="mf">0.790569415042096</span> <span class="o">*</span> <span class="n">sh_3_3</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="253">        <span class="o">+</span> <span class="mf">0.968245836551854</span> <span class="o">*</span> <span class="n">sh_3_4</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="254">        <span class="o">-</span> <span class="mf">0.306186217847897</span> <span class="o">*</span> <span class="n">sh_3_5</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="255">    <span class="p">)</span>
</span><span data-line="256">    <span class="n">sh_4_6</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="257">        <span class="o">-</span><span class="mf">0.176776695296637</span> <span class="o">*</span> <span class="n">sh_3_0</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="258">        <span class="o">-</span> <span class="mf">0.684653196881457</span> <span class="o">*</span> <span class="n">sh_3_2</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="259">        <span class="o">+</span> <span class="mf">0.684653196881457</span> <span class="o">*</span> <span class="n">sh_3_4</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="260">        <span class="o">+</span> <span class="mf">0.866025403784439</span> <span class="o">*</span> <span class="n">sh_3_5</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="261">        <span class="o">-</span> <span class="mf">0.176776695296637</span> <span class="o">*</span> <span class="n">sh_3_6</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="262">    <span class="p">)</span>
</span><span data-line="263">    <span class="n">sh_4_7</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="264">        <span class="o">-</span><span class="mf">0.810092587300982</span> <span class="o">*</span> <span class="n">sh_3_1</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="265">        <span class="o">+</span> <span class="mf">0.810092587300982</span> <span class="o">*</span> <span class="n">sh_3_5</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="266">        <span class="o">+</span> <span class="mf">0.661437827766148</span> <span class="o">*</span> <span class="n">sh_3_6</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="267">    <span class="p">)</span>
</span><span data-line="268">    <span class="n">sh_4_8</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.935414346693485</span> <span class="o">*</span> <span class="n">sh_3_0</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.935414346693486</span> <span class="o">*</span> <span class="n">sh_3_6</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="269">    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span data-line="270">        <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
</span><span data-line="271">            <span class="p">[</span>
</span><span data-line="272">                <span class="n">sh_4_0</span><span class="p">,</span>
</span><span data-line="273">                <span class="n">sh_4_1</span><span class="p">,</span>
</span><span data-line="274">                <span class="n">sh_4_2</span><span class="p">,</span>
</span><span data-line="275">                <span class="n">sh_4_3</span><span class="p">,</span>
</span><span data-line="276">                <span class="n">sh_4_4</span><span class="p">,</span>
</span><span data-line="277">                <span class="n">sh_4_5</span><span class="p">,</span>
</span><span data-line="278">                <span class="n">sh_4_6</span><span class="p">,</span>
</span><span data-line="279">                <span class="n">sh_4_7</span><span class="p">,</span>
</span><span data-line="280">                <span class="n">sh_4_8</span><span class="p">,</span>
</span><span data-line="281">            <span class="p">],</span>
</span><span data-line="282">            <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
</span><span data-line="283">        <span class="p">)</span>
</span><span data-line="284">    <span class="p">)</span>
</span><span data-line="285">    <span class="k">if</span> <span class="n">lmax</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
</span><span data-line="286">        <span class="k">return</span> <span class="n">out</span>
</span><span data-line="287">
</span><span data-line="288">    <span class="n">sh_5_0</span> <span class="o">=</span> <span class="mf">0.948683298050513</span> <span class="o">*</span> <span class="n">sh_4_0</span> <span class="o">*</span> <span class="n">z</span> <span class="o">+</span> <span class="mf">0.948683298050513</span> <span class="o">*</span> <span class="n">sh_4_8</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="289">    <span class="n">sh_5_1</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="290">        <span class="mf">0.6</span> <span class="o">*</span> <span class="n">sh_4_0</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="291">        <span class="o">+</span> <span class="mf">0.848528137423857</span> <span class="o">*</span> <span class="n">sh_4_1</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="292">        <span class="o">+</span> <span class="mf">0.848528137423858</span> <span class="o">*</span> <span class="n">sh_4_7</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="293">    <span class="p">)</span>
</span><span data-line="294">    <span class="n">sh_5_2</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="295">        <span class="o">-</span><span class="mf">0.14142135623731</span> <span class="o">*</span> <span class="n">sh_4_0</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="296">        <span class="o">+</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">sh_4_1</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="297">        <span class="o">+</span> <span class="mf">0.748331477354788</span> <span class="o">*</span> <span class="n">sh_4_2</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="298">        <span class="o">+</span> <span class="mf">0.748331477354788</span> <span class="o">*</span> <span class="n">sh_4_6</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="299">        <span class="o">+</span> <span class="mf">0.14142135623731</span> <span class="o">*</span> <span class="n">sh_4_8</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="300">    <span class="p">)</span>
</span><span data-line="301">    <span class="n">sh_5_3</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="302">        <span class="o">-</span><span class="mf">0.244948974278318</span> <span class="o">*</span> <span class="n">sh_4_1</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="303">        <span class="o">+</span> <span class="mf">0.916515138991168</span> <span class="o">*</span> <span class="n">sh_4_2</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="304">        <span class="o">+</span> <span class="mf">0.648074069840786</span> <span class="o">*</span> <span class="n">sh_4_3</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="305">        <span class="o">+</span> <span class="mf">0.648074069840787</span> <span class="o">*</span> <span class="n">sh_4_5</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="306">        <span class="o">+</span> <span class="mf">0.244948974278318</span> <span class="o">*</span> <span class="n">sh_4_7</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="307">    <span class="p">)</span>
</span><span data-line="308">    <span class="n">sh_5_4</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="309">        <span class="o">-</span><span class="mf">0.346410161513776</span> <span class="o">*</span> <span class="n">sh_4_2</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="310">        <span class="o">+</span> <span class="mf">0.979795897113272</span> <span class="o">*</span> <span class="n">sh_4_3</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="311">        <span class="o">+</span> <span class="mf">0.774596669241484</span> <span class="o">*</span> <span class="n">sh_4_4</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="312">        <span class="o">+</span> <span class="mf">0.346410161513776</span> <span class="o">*</span> <span class="n">sh_4_6</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="313">    <span class="p">)</span>
</span><span data-line="314">    <span class="n">sh_5_5</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="315">        <span class="o">-</span><span class="mf">0.632455532033676</span> <span class="o">*</span> <span class="n">sh_4_3</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="316">        <span class="o">+</span> <span class="n">sh_4_4</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="317">        <span class="o">-</span> <span class="mf">0.632455532033676</span> <span class="o">*</span> <span class="n">sh_4_5</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="318">    <span class="p">)</span>
</span><span data-line="319">    <span class="n">sh_5_6</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="320">        <span class="o">-</span><span class="mf">0.346410161513776</span> <span class="o">*</span> <span class="n">sh_4_2</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="321">        <span class="o">+</span> <span class="mf">0.774596669241483</span> <span class="o">*</span> <span class="n">sh_4_4</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="322">        <span class="o">+</span> <span class="mf">0.979795897113273</span> <span class="o">*</span> <span class="n">sh_4_5</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="323">        <span class="o">-</span> <span class="mf">0.346410161513776</span> <span class="o">*</span> <span class="n">sh_4_6</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="324">    <span class="p">)</span>
</span><span data-line="325">    <span class="n">sh_5_7</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="326">        <span class="o">-</span><span class="mf">0.244948974278318</span> <span class="o">*</span> <span class="n">sh_4_1</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="327">        <span class="o">-</span> <span class="mf">0.648074069840787</span> <span class="o">*</span> <span class="n">sh_4_3</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="328">        <span class="o">+</span> <span class="mf">0.648074069840786</span> <span class="o">*</span> <span class="n">sh_4_5</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="329">        <span class="o">+</span> <span class="mf">0.916515138991169</span> <span class="o">*</span> <span class="n">sh_4_6</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="330">        <span class="o">-</span> <span class="mf">0.244948974278318</span> <span class="o">*</span> <span class="n">sh_4_7</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="331">    <span class="p">)</span>
</span><span data-line="332">    <span class="n">sh_5_8</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="333">        <span class="o">-</span><span class="mf">0.141421356237309</span> <span class="o">*</span> <span class="n">sh_4_0</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="334">        <span class="o">-</span> <span class="mf">0.748331477354788</span> <span class="o">*</span> <span class="n">sh_4_2</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="335">        <span class="o">+</span> <span class="mf">0.748331477354788</span> <span class="o">*</span> <span class="n">sh_4_6</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="336">        <span class="o">+</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">sh_4_7</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="337">        <span class="o">-</span> <span class="mf">0.141421356237309</span> <span class="o">*</span> <span class="n">sh_4_8</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="338">    <span class="p">)</span>
</span><span data-line="339">    <span class="n">sh_5_9</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="340">        <span class="o">-</span><span class="mf">0.848528137423857</span> <span class="o">*</span> <span class="n">sh_4_1</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="341">        <span class="o">+</span> <span class="mf">0.848528137423857</span> <span class="o">*</span> <span class="n">sh_4_7</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="342">        <span class="o">+</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">sh_4_8</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="343">    <span class="p">)</span>
</span><span data-line="344">    <span class="n">sh_5_10</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.948683298050513</span> <span class="o">*</span> <span class="n">sh_4_0</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.948683298050513</span> <span class="o">*</span> <span class="n">sh_4_8</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="345">    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span data-line="346">        <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
</span><span data-line="347">            <span class="p">[</span>
</span><span data-line="348">                <span class="n">sh_5_0</span><span class="p">,</span>
</span><span data-line="349">                <span class="n">sh_5_1</span><span class="p">,</span>
</span><span data-line="350">                <span class="n">sh_5_2</span><span class="p">,</span>
</span><span data-line="351">                <span class="n">sh_5_3</span><span class="p">,</span>
</span><span data-line="352">                <span class="n">sh_5_4</span><span class="p">,</span>
</span><span data-line="353">                <span class="n">sh_5_5</span><span class="p">,</span>
</span><span data-line="354">                <span class="n">sh_5_6</span><span class="p">,</span>
</span><span data-line="355">                <span class="n">sh_5_7</span><span class="p">,</span>
</span><span data-line="356">                <span class="n">sh_5_8</span><span class="p">,</span>
</span><span data-line="357">                <span class="n">sh_5_9</span><span class="p">,</span>
</span><span data-line="358">                <span class="n">sh_5_10</span><span class="p">,</span>
</span><span data-line="359">            <span class="p">],</span>
</span><span data-line="360">            <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
</span><span data-line="361">        <span class="p">)</span>
</span><span data-line="362">    <span class="p">)</span>
</span><span data-line="363">    <span class="k">if</span> <span class="n">lmax</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
</span><span data-line="364">        <span class="k">return</span> <span class="n">out</span>
</span><span data-line="365">
</span><span data-line="366">    <span class="n">sh_6_0</span> <span class="o">=</span> <span class="mf">0.957427107756337</span> <span class="o">*</span> <span class="n">sh_5_0</span> <span class="o">*</span> <span class="n">z</span> <span class="o">+</span> <span class="mf">0.957427107756338</span> <span class="o">*</span> <span class="n">sh_5_10</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="367">    <span class="n">sh_6_1</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="368">        <span class="mf">0.552770798392565</span> <span class="o">*</span> <span class="n">sh_5_0</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="369">        <span class="o">+</span> <span class="mf">0.874007373475125</span> <span class="o">*</span> <span class="n">sh_5_1</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="370">        <span class="o">+</span> <span class="mf">0.874007373475125</span> <span class="o">*</span> <span class="n">sh_5_9</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="371">    <span class="p">)</span>
</span><span data-line="372">    <span class="n">sh_6_2</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="373">        <span class="o">-</span><span class="mf">0.117851130197757</span> <span class="o">*</span> <span class="n">sh_5_0</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="374">        <span class="o">+</span> <span class="mf">0.745355992499929</span> <span class="o">*</span> <span class="n">sh_5_1</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="375">        <span class="o">+</span> <span class="mf">0.117851130197758</span> <span class="o">*</span> <span class="n">sh_5_10</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="376">        <span class="o">+</span> <span class="mf">0.790569415042094</span> <span class="o">*</span> <span class="n">sh_5_2</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="377">        <span class="o">+</span> <span class="mf">0.790569415042093</span> <span class="o">*</span> <span class="n">sh_5_8</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="378">    <span class="p">)</span>
</span><span data-line="379">    <span class="n">sh_6_3</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="380">        <span class="o">-</span><span class="mf">0.204124145231931</span> <span class="o">*</span> <span class="n">sh_5_1</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="381">        <span class="o">+</span> <span class="mf">0.866025403784437</span> <span class="o">*</span> <span class="n">sh_5_2</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="382">        <span class="o">+</span> <span class="mf">0.707106781186546</span> <span class="o">*</span> <span class="n">sh_5_3</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="383">        <span class="o">+</span> <span class="mf">0.707106781186547</span> <span class="o">*</span> <span class="n">sh_5_7</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="384">        <span class="o">+</span> <span class="mf">0.204124145231931</span> <span class="o">*</span> <span class="n">sh_5_9</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="385">    <span class="p">)</span>
</span><span data-line="386">    <span class="n">sh_6_4</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="387">        <span class="o">-</span><span class="mf">0.288675134594813</span> <span class="o">*</span> <span class="n">sh_5_2</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="388">        <span class="o">+</span> <span class="mf">0.942809041582062</span> <span class="o">*</span> <span class="n">sh_5_3</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="389">        <span class="o">+</span> <span class="mf">0.623609564462323</span> <span class="o">*</span> <span class="n">sh_5_4</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="390">        <span class="o">+</span> <span class="mf">0.623609564462322</span> <span class="o">*</span> <span class="n">sh_5_6</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="391">        <span class="o">+</span> <span class="mf">0.288675134594812</span> <span class="o">*</span> <span class="n">sh_5_8</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="392">    <span class="p">)</span>
</span><span data-line="393">    <span class="n">sh_6_5</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="394">        <span class="o">-</span><span class="mf">0.372677996249965</span> <span class="o">*</span> <span class="n">sh_5_3</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="395">        <span class="o">+</span> <span class="mf">0.986013297183268</span> <span class="o">*</span> <span class="n">sh_5_4</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="396">        <span class="o">+</span> <span class="mf">0.763762615825972</span> <span class="o">*</span> <span class="n">sh_5_5</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="397">        <span class="o">+</span> <span class="mf">0.372677996249964</span> <span class="o">*</span> <span class="n">sh_5_7</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="398">    <span class="p">)</span>
</span><span data-line="399">    <span class="n">sh_6_6</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="400">        <span class="o">-</span><span class="mf">0.645497224367901</span> <span class="o">*</span> <span class="n">sh_5_4</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="401">        <span class="o">+</span> <span class="n">sh_5_5</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="402">        <span class="o">-</span> <span class="mf">0.645497224367902</span> <span class="o">*</span> <span class="n">sh_5_6</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="403">    <span class="p">)</span>
</span><span data-line="404">    <span class="n">sh_6_7</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="405">        <span class="o">-</span><span class="mf">0.372677996249964</span> <span class="o">*</span> <span class="n">sh_5_3</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="406">        <span class="o">+</span> <span class="mf">0.763762615825972</span> <span class="o">*</span> <span class="n">sh_5_5</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="407">        <span class="o">+</span> <span class="mf">0.986013297183269</span> <span class="o">*</span> <span class="n">sh_5_6</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="408">        <span class="o">-</span> <span class="mf">0.372677996249965</span> <span class="o">*</span> <span class="n">sh_5_7</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="409">    <span class="p">)</span>
</span><span data-line="410">    <span class="n">sh_6_8</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="411">        <span class="o">-</span><span class="mf">0.288675134594813</span> <span class="o">*</span> <span class="n">sh_5_2</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="412">        <span class="o">-</span> <span class="mf">0.623609564462323</span> <span class="o">*</span> <span class="n">sh_5_4</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="413">        <span class="o">+</span> <span class="mf">0.623609564462323</span> <span class="o">*</span> <span class="n">sh_5_6</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="414">        <span class="o">+</span> <span class="mf">0.942809041582062</span> <span class="o">*</span> <span class="n">sh_5_7</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="415">        <span class="o">-</span> <span class="mf">0.288675134594812</span> <span class="o">*</span> <span class="n">sh_5_8</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="416">    <span class="p">)</span>
</span><span data-line="417">    <span class="n">sh_6_9</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="418">        <span class="o">-</span><span class="mf">0.20412414523193</span> <span class="o">*</span> <span class="n">sh_5_1</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="419">        <span class="o">-</span> <span class="mf">0.707106781186546</span> <span class="o">*</span> <span class="n">sh_5_3</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="420">        <span class="o">+</span> <span class="mf">0.707106781186547</span> <span class="o">*</span> <span class="n">sh_5_7</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="421">        <span class="o">+</span> <span class="mf">0.866025403784438</span> <span class="o">*</span> <span class="n">sh_5_8</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="422">        <span class="o">-</span> <span class="mf">0.204124145231931</span> <span class="o">*</span> <span class="n">sh_5_9</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="423">    <span class="p">)</span>
</span><span data-line="424">    <span class="n">sh_6_10</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="425">        <span class="o">-</span><span class="mf">0.117851130197757</span> <span class="o">*</span> <span class="n">sh_5_0</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="426">        <span class="o">-</span> <span class="mf">0.117851130197757</span> <span class="o">*</span> <span class="n">sh_5_10</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="427">        <span class="o">-</span> <span class="mf">0.790569415042094</span> <span class="o">*</span> <span class="n">sh_5_2</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="428">        <span class="o">+</span> <span class="mf">0.790569415042093</span> <span class="o">*</span> <span class="n">sh_5_8</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="429">        <span class="o">+</span> <span class="mf">0.745355992499929</span> <span class="o">*</span> <span class="n">sh_5_9</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="430">    <span class="p">)</span>
</span><span data-line="431">    <span class="n">sh_6_11</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="432">        <span class="o">-</span><span class="mf">0.874007373475124</span> <span class="o">*</span> <span class="n">sh_5_1</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="433">        <span class="o">+</span> <span class="mf">0.552770798392566</span> <span class="o">*</span> <span class="n">sh_5_10</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="434">        <span class="o">+</span> <span class="mf">0.874007373475125</span> <span class="o">*</span> <span class="n">sh_5_9</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="435">    <span class="p">)</span>
</span><span data-line="436">    <span class="n">sh_6_12</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.957427107756337</span> <span class="o">*</span> <span class="n">sh_5_0</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.957427107756336</span> <span class="o">*</span> <span class="n">sh_5_10</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="437">    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span data-line="438">        <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
</span><span data-line="439">            <span class="p">[</span>
</span><span data-line="440">                <span class="n">sh_6_0</span><span class="p">,</span>
</span><span data-line="441">                <span class="n">sh_6_1</span><span class="p">,</span>
</span><span data-line="442">                <span class="n">sh_6_2</span><span class="p">,</span>
</span><span data-line="443">                <span class="n">sh_6_3</span><span class="p">,</span>
</span><span data-line="444">                <span class="n">sh_6_4</span><span class="p">,</span>
</span><span data-line="445">                <span class="n">sh_6_5</span><span class="p">,</span>
</span><span data-line="446">                <span class="n">sh_6_6</span><span class="p">,</span>
</span><span data-line="447">                <span class="n">sh_6_7</span><span class="p">,</span>
</span><span data-line="448">                <span class="n">sh_6_8</span><span class="p">,</span>
</span><span data-line="449">                <span class="n">sh_6_9</span><span class="p">,</span>
</span><span data-line="450">                <span class="n">sh_6_10</span><span class="p">,</span>
</span><span data-line="451">                <span class="n">sh_6_11</span><span class="p">,</span>
</span><span data-line="452">                <span class="n">sh_6_12</span><span class="p">,</span>
</span><span data-line="453">            <span class="p">],</span>
</span><span data-line="454">            <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
</span><span data-line="455">        <span class="p">)</span>
</span><span data-line="456">    <span class="p">)</span>
</span><span data-line="457">    <span class="k">if</span> <span class="n">lmax</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
</span><span data-line="458">        <span class="k">return</span> <span class="n">out</span>
</span><span data-line="459">
</span><span data-line="460">    <span class="n">sh_7_0</span> <span class="o">=</span> <span class="mf">0.963624111659433</span> <span class="o">*</span> <span class="n">sh_6_0</span> <span class="o">*</span> <span class="n">z</span> <span class="o">+</span> <span class="mf">0.963624111659432</span> <span class="o">*</span> <span class="n">sh_6_12</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="461">    <span class="n">sh_7_1</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="462">        <span class="mf">0.515078753637713</span> <span class="o">*</span> <span class="n">sh_6_0</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="463">        <span class="o">+</span> <span class="mf">0.892142571199771</span> <span class="o">*</span> <span class="n">sh_6_1</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="464">        <span class="o">+</span> <span class="mf">0.892142571199771</span> <span class="o">*</span> <span class="n">sh_6_11</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="465">    <span class="p">)</span>
</span><span data-line="466">    <span class="n">sh_7_2</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="467">        <span class="o">-</span><span class="mf">0.101015254455221</span> <span class="o">*</span> <span class="n">sh_6_0</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="468">        <span class="o">+</span> <span class="mf">0.699854212223765</span> <span class="o">*</span> <span class="n">sh_6_1</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="469">        <span class="o">+</span> <span class="mf">0.82065180664829</span> <span class="o">*</span> <span class="n">sh_6_10</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="470">        <span class="o">+</span> <span class="mf">0.101015254455222</span> <span class="o">*</span> <span class="n">sh_6_12</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="471">        <span class="o">+</span> <span class="mf">0.82065180664829</span> <span class="o">*</span> <span class="n">sh_6_2</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="472">    <span class="p">)</span>
</span><span data-line="473">    <span class="n">sh_7_3</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="474">        <span class="o">-</span><span class="mf">0.174963553055942</span> <span class="o">*</span> <span class="n">sh_6_1</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="475">        <span class="o">+</span> <span class="mf">0.174963553055941</span> <span class="o">*</span> <span class="n">sh_6_11</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="476">        <span class="o">+</span> <span class="mf">0.82065180664829</span> <span class="o">*</span> <span class="n">sh_6_2</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="477">        <span class="o">+</span> <span class="mf">0.749149177264394</span> <span class="o">*</span> <span class="n">sh_6_3</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="478">        <span class="o">+</span> <span class="mf">0.749149177264394</span> <span class="o">*</span> <span class="n">sh_6_9</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="479">    <span class="p">)</span>
</span><span data-line="480">    <span class="n">sh_7_4</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="481">        <span class="mf">0.247435829652697</span> <span class="o">*</span> <span class="n">sh_6_10</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="482">        <span class="o">-</span> <span class="mf">0.247435829652697</span> <span class="o">*</span> <span class="n">sh_6_2</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="483">        <span class="o">+</span> <span class="mf">0.903507902905251</span> <span class="o">*</span> <span class="n">sh_6_3</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="484">        <span class="o">+</span> <span class="mf">0.677630927178938</span> <span class="o">*</span> <span class="n">sh_6_4</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="485">        <span class="o">+</span> <span class="mf">0.677630927178938</span> <span class="o">*</span> <span class="n">sh_6_8</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="486">    <span class="p">)</span>
</span><span data-line="487">    <span class="n">sh_7_5</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="488">        <span class="o">-</span><span class="mf">0.31943828249997</span> <span class="o">*</span> <span class="n">sh_6_3</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="489">        <span class="o">+</span> <span class="mf">0.95831484749991</span> <span class="o">*</span> <span class="n">sh_6_4</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="490">        <span class="o">+</span> <span class="mf">0.606091526731326</span> <span class="o">*</span> <span class="n">sh_6_5</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="491">        <span class="o">+</span> <span class="mf">0.606091526731326</span> <span class="o">*</span> <span class="n">sh_6_7</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="492">        <span class="o">+</span> <span class="mf">0.31943828249997</span> <span class="o">*</span> <span class="n">sh_6_9</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="493">    <span class="p">)</span>
</span><span data-line="494">    <span class="n">sh_7_6</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="495">        <span class="o">-</span><span class="mf">0.391230398217976</span> <span class="o">*</span> <span class="n">sh_6_4</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="496">        <span class="o">+</span> <span class="mf">0.989743318610787</span> <span class="o">*</span> <span class="n">sh_6_5</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="497">        <span class="o">+</span> <span class="mf">0.755928946018454</span> <span class="o">*</span> <span class="n">sh_6_6</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="498">        <span class="o">+</span> <span class="mf">0.391230398217975</span> <span class="o">*</span> <span class="n">sh_6_8</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="499">    <span class="p">)</span>
</span><span data-line="500">    <span class="n">sh_7_7</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="501">        <span class="o">-</span><span class="mf">0.654653670707977</span> <span class="o">*</span> <span class="n">sh_6_5</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="502">        <span class="o">+</span> <span class="n">sh_6_6</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="503">        <span class="o">-</span> <span class="mf">0.654653670707978</span> <span class="o">*</span> <span class="n">sh_6_7</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="504">    <span class="p">)</span>
</span><span data-line="505">    <span class="n">sh_7_8</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="506">        <span class="o">-</span><span class="mf">0.391230398217976</span> <span class="o">*</span> <span class="n">sh_6_4</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="507">        <span class="o">+</span> <span class="mf">0.755928946018455</span> <span class="o">*</span> <span class="n">sh_6_6</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="508">        <span class="o">+</span> <span class="mf">0.989743318610787</span> <span class="o">*</span> <span class="n">sh_6_7</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="509">        <span class="o">-</span> <span class="mf">0.391230398217975</span> <span class="o">*</span> <span class="n">sh_6_8</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="510">    <span class="p">)</span>
</span><span data-line="511">    <span class="n">sh_7_9</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="512">        <span class="o">-</span><span class="mf">0.31943828249997</span> <span class="o">*</span> <span class="n">sh_6_3</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="513">        <span class="o">-</span> <span class="mf">0.606091526731327</span> <span class="o">*</span> <span class="n">sh_6_5</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="514">        <span class="o">+</span> <span class="mf">0.606091526731326</span> <span class="o">*</span> <span class="n">sh_6_7</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="515">        <span class="o">+</span> <span class="mf">0.95831484749991</span> <span class="o">*</span> <span class="n">sh_6_8</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="516">        <span class="o">-</span> <span class="mf">0.31943828249997</span> <span class="o">*</span> <span class="n">sh_6_9</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="517">    <span class="p">)</span>
</span><span data-line="518">    <span class="n">sh_7_10</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="519">        <span class="o">-</span><span class="mf">0.247435829652697</span> <span class="o">*</span> <span class="n">sh_6_10</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="520">        <span class="o">-</span> <span class="mf">0.247435829652697</span> <span class="o">*</span> <span class="n">sh_6_2</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="521">        <span class="o">-</span> <span class="mf">0.677630927178938</span> <span class="o">*</span> <span class="n">sh_6_4</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="522">        <span class="o">+</span> <span class="mf">0.677630927178938</span> <span class="o">*</span> <span class="n">sh_6_8</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="523">        <span class="o">+</span> <span class="mf">0.903507902905251</span> <span class="o">*</span> <span class="n">sh_6_9</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="524">    <span class="p">)</span>
</span><span data-line="525">    <span class="n">sh_7_11</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="526">        <span class="o">-</span><span class="mf">0.174963553055942</span> <span class="o">*</span> <span class="n">sh_6_1</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="527">        <span class="o">+</span> <span class="mf">0.820651806648289</span> <span class="o">*</span> <span class="n">sh_6_10</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="528">        <span class="o">-</span> <span class="mf">0.174963553055941</span> <span class="o">*</span> <span class="n">sh_6_11</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="529">        <span class="o">-</span> <span class="mf">0.749149177264394</span> <span class="o">*</span> <span class="n">sh_6_3</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="530">        <span class="o">+</span> <span class="mf">0.749149177264394</span> <span class="o">*</span> <span class="n">sh_6_9</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="531">    <span class="p">)</span>
</span><span data-line="532">    <span class="n">sh_7_12</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="533">        <span class="o">-</span><span class="mf">0.101015254455221</span> <span class="o">*</span> <span class="n">sh_6_0</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="534">        <span class="o">+</span> <span class="mf">0.82065180664829</span> <span class="o">*</span> <span class="n">sh_6_10</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="535">        <span class="o">+</span> <span class="mf">0.699854212223766</span> <span class="o">*</span> <span class="n">sh_6_11</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="536">        <span class="o">-</span> <span class="mf">0.101015254455221</span> <span class="o">*</span> <span class="n">sh_6_12</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="537">        <span class="o">-</span> <span class="mf">0.82065180664829</span> <span class="o">*</span> <span class="n">sh_6_2</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="538">    <span class="p">)</span>
</span><span data-line="539">    <span class="n">sh_7_13</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="540">        <span class="o">-</span><span class="mf">0.892142571199772</span> <span class="o">*</span> <span class="n">sh_6_1</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="541">        <span class="o">+</span> <span class="mf">0.892142571199772</span> <span class="o">*</span> <span class="n">sh_6_11</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="542">        <span class="o">+</span> <span class="mf">0.515078753637713</span> <span class="o">*</span> <span class="n">sh_6_12</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="543">    <span class="p">)</span>
</span><span data-line="544">    <span class="n">sh_7_14</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.963624111659431</span> <span class="o">*</span> <span class="n">sh_6_0</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.963624111659433</span> <span class="o">*</span> <span class="n">sh_6_12</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="545">    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span data-line="546">        <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
</span><span data-line="547">            <span class="p">[</span>
</span><span data-line="548">                <span class="n">sh_7_0</span><span class="p">,</span>
</span><span data-line="549">                <span class="n">sh_7_1</span><span class="p">,</span>
</span><span data-line="550">                <span class="n">sh_7_2</span><span class="p">,</span>
</span><span data-line="551">                <span class="n">sh_7_3</span><span class="p">,</span>
</span><span data-line="552">                <span class="n">sh_7_4</span><span class="p">,</span>
</span><span data-line="553">                <span class="n">sh_7_5</span><span class="p">,</span>
</span><span data-line="554">                <span class="n">sh_7_6</span><span class="p">,</span>
</span><span data-line="555">                <span class="n">sh_7_7</span><span class="p">,</span>
</span><span data-line="556">                <span class="n">sh_7_8</span><span class="p">,</span>
</span><span data-line="557">                <span class="n">sh_7_9</span><span class="p">,</span>
</span><span data-line="558">                <span class="n">sh_7_10</span><span class="p">,</span>
</span><span data-line="559">                <span class="n">sh_7_11</span><span class="p">,</span>
</span><span data-line="560">                <span class="n">sh_7_12</span><span class="p">,</span>
</span><span data-line="561">                <span class="n">sh_7_13</span><span class="p">,</span>
</span><span data-line="562">                <span class="n">sh_7_14</span><span class="p">,</span>
</span><span data-line="563">            <span class="p">],</span>
</span><span data-line="564">            <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
</span><span data-line="565">        <span class="p">)</span>
</span><span data-line="566">    <span class="p">)</span>
</span><span data-line="567">    <span class="k">if</span> <span class="n">lmax</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
</span><span data-line="568">        <span class="k">return</span> <span class="n">out</span>
</span><span data-line="569">
</span><span data-line="570">    <span class="n">sh_8_0</span> <span class="o">=</span> <span class="mf">0.968245836551854</span> <span class="o">*</span> <span class="n">sh_7_0</span> <span class="o">*</span> <span class="n">z</span> <span class="o">+</span> <span class="mf">0.968245836551853</span> <span class="o">*</span> <span class="n">sh_7_14</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="571">    <span class="n">sh_8_1</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="572">        <span class="mf">0.484122918275928</span> <span class="o">*</span> <span class="n">sh_7_0</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="573">        <span class="o">+</span> <span class="mf">0.90571104663684</span> <span class="o">*</span> <span class="n">sh_7_1</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="574">        <span class="o">+</span> <span class="mf">0.90571104663684</span> <span class="o">*</span> <span class="n">sh_7_13</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="575">    <span class="p">)</span>
</span><span data-line="576">    <span class="n">sh_8_2</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="577">        <span class="o">-</span><span class="mf">0.0883883476483189</span> <span class="o">*</span> <span class="n">sh_7_0</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="578">        <span class="o">+</span> <span class="mf">0.661437827766148</span> <span class="o">*</span> <span class="n">sh_7_1</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="579">        <span class="o">+</span> <span class="mf">0.843171097702002</span> <span class="o">*</span> <span class="n">sh_7_12</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="580">        <span class="o">+</span> <span class="mf">0.088388347648318</span> <span class="o">*</span> <span class="n">sh_7_14</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="581">        <span class="o">+</span> <span class="mf">0.843171097702003</span> <span class="o">*</span> <span class="n">sh_7_2</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="582">    <span class="p">)</span>
</span><span data-line="583">    <span class="n">sh_8_3</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="584">        <span class="o">-</span><span class="mf">0.153093108923948</span> <span class="o">*</span> <span class="n">sh_7_1</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="585">        <span class="o">+</span> <span class="mf">0.7806247497998</span> <span class="o">*</span> <span class="n">sh_7_11</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="586">        <span class="o">+</span> <span class="mf">0.153093108923949</span> <span class="o">*</span> <span class="n">sh_7_13</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="587">        <span class="o">+</span> <span class="mf">0.7806247497998</span> <span class="o">*</span> <span class="n">sh_7_2</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="588">        <span class="o">+</span> <span class="mf">0.780624749799799</span> <span class="o">*</span> <span class="n">sh_7_3</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="589">    <span class="p">)</span>
</span><span data-line="590">    <span class="n">sh_8_4</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="591">        <span class="mf">0.718070330817253</span> <span class="o">*</span> <span class="n">sh_7_10</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="592">        <span class="o">+</span> <span class="mf">0.21650635094611</span> <span class="o">*</span> <span class="n">sh_7_12</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="593">        <span class="o">-</span> <span class="mf">0.21650635094611</span> <span class="o">*</span> <span class="n">sh_7_2</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="594">        <span class="o">+</span> <span class="mf">0.866025403784439</span> <span class="o">*</span> <span class="n">sh_7_3</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="595">        <span class="o">+</span> <span class="mf">0.718070330817254</span> <span class="o">*</span> <span class="n">sh_7_4</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="596">    <span class="p">)</span>
</span><span data-line="597">    <span class="n">sh_8_5</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="598">        <span class="mf">0.279508497187474</span> <span class="o">*</span> <span class="n">sh_7_11</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="599">        <span class="o">-</span> <span class="mf">0.279508497187474</span> <span class="o">*</span> <span class="n">sh_7_3</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="600">        <span class="o">+</span> <span class="mf">0.927024810886958</span> <span class="o">*</span> <span class="n">sh_7_4</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="601">        <span class="o">+</span> <span class="mf">0.655505530106345</span> <span class="o">*</span> <span class="n">sh_7_5</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="602">        <span class="o">+</span> <span class="mf">0.655505530106344</span> <span class="o">*</span> <span class="n">sh_7_9</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="603">    <span class="p">)</span>
</span><span data-line="604">    <span class="n">sh_8_6</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="605">        <span class="mf">0.342326598440729</span> <span class="o">*</span> <span class="n">sh_7_10</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="606">        <span class="o">-</span> <span class="mf">0.342326598440729</span> <span class="o">*</span> <span class="n">sh_7_4</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="607">        <span class="o">+</span> <span class="mf">0.968245836551854</span> <span class="o">*</span> <span class="n">sh_7_5</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="608">        <span class="o">+</span> <span class="mf">0.592927061281572</span> <span class="o">*</span> <span class="n">sh_7_6</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="609">        <span class="o">+</span> <span class="mf">0.592927061281571</span> <span class="o">*</span> <span class="n">sh_7_8</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="610">    <span class="p">)</span>
</span><span data-line="611">    <span class="n">sh_8_7</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="612">        <span class="o">-</span><span class="mf">0.405046293650492</span> <span class="o">*</span> <span class="n">sh_7_5</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="613">        <span class="o">+</span> <span class="mf">0.992156741649221</span> <span class="o">*</span> <span class="n">sh_7_6</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="614">        <span class="o">+</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="n">sh_7_7</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="615">        <span class="o">+</span> <span class="mf">0.405046293650492</span> <span class="o">*</span> <span class="n">sh_7_9</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="616">    <span class="p">)</span>
</span><span data-line="617">    <span class="n">sh_8_8</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="618">        <span class="o">-</span><span class="mf">0.661437827766148</span> <span class="o">*</span> <span class="n">sh_7_6</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="619">        <span class="o">+</span> <span class="n">sh_7_7</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="620">        <span class="o">-</span> <span class="mf">0.661437827766148</span> <span class="o">*</span> <span class="n">sh_7_8</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="621">    <span class="p">)</span>
</span><span data-line="622">    <span class="n">sh_8_9</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="623">        <span class="o">-</span><span class="mf">0.405046293650492</span> <span class="o">*</span> <span class="n">sh_7_5</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="624">        <span class="o">+</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="n">sh_7_7</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="625">        <span class="o">+</span> <span class="mf">0.992156741649221</span> <span class="o">*</span> <span class="n">sh_7_8</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="626">        <span class="o">-</span> <span class="mf">0.405046293650491</span> <span class="o">*</span> <span class="n">sh_7_9</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="627">    <span class="p">)</span>
</span><span data-line="628">    <span class="n">sh_8_10</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="629">        <span class="o">-</span><span class="mf">0.342326598440728</span> <span class="o">*</span> <span class="n">sh_7_10</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="630">        <span class="o">-</span> <span class="mf">0.342326598440729</span> <span class="o">*</span> <span class="n">sh_7_4</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="631">        <span class="o">-</span> <span class="mf">0.592927061281571</span> <span class="o">*</span> <span class="n">sh_7_6</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="632">        <span class="o">+</span> <span class="mf">0.592927061281571</span> <span class="o">*</span> <span class="n">sh_7_8</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="633">        <span class="o">+</span> <span class="mf">0.968245836551855</span> <span class="o">*</span> <span class="n">sh_7_9</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="634">    <span class="p">)</span>
</span><span data-line="635">    <span class="n">sh_8_11</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="636">        <span class="mf">0.927024810886958</span> <span class="o">*</span> <span class="n">sh_7_10</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="637">        <span class="o">-</span> <span class="mf">0.279508497187474</span> <span class="o">*</span> <span class="n">sh_7_11</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="638">        <span class="o">-</span> <span class="mf">0.279508497187474</span> <span class="o">*</span> <span class="n">sh_7_3</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="639">        <span class="o">-</span> <span class="mf">0.655505530106345</span> <span class="o">*</span> <span class="n">sh_7_5</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="640">        <span class="o">+</span> <span class="mf">0.655505530106345</span> <span class="o">*</span> <span class="n">sh_7_9</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="641">    <span class="p">)</span>
</span><span data-line="642">    <span class="n">sh_8_12</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="643">        <span class="mf">0.718070330817253</span> <span class="o">*</span> <span class="n">sh_7_10</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="644">        <span class="o">+</span> <span class="mf">0.866025403784439</span> <span class="o">*</span> <span class="n">sh_7_11</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="645">        <span class="o">-</span> <span class="mf">0.216506350946109</span> <span class="o">*</span> <span class="n">sh_7_12</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="646">        <span class="o">-</span> <span class="mf">0.216506350946109</span> <span class="o">*</span> <span class="n">sh_7_2</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="647">        <span class="o">-</span> <span class="mf">0.718070330817254</span> <span class="o">*</span> <span class="n">sh_7_4</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="648">    <span class="p">)</span>
</span><span data-line="649">    <span class="n">sh_8_13</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="650">        <span class="o">-</span><span class="mf">0.153093108923948</span> <span class="o">*</span> <span class="n">sh_7_1</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="651">        <span class="o">+</span> <span class="mf">0.7806247497998</span> <span class="o">*</span> <span class="n">sh_7_11</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="652">        <span class="o">+</span> <span class="mf">0.7806247497998</span> <span class="o">*</span> <span class="n">sh_7_12</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="653">        <span class="o">-</span> <span class="mf">0.153093108923948</span> <span class="o">*</span> <span class="n">sh_7_13</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="654">        <span class="o">-</span> <span class="mf">0.780624749799799</span> <span class="o">*</span> <span class="n">sh_7_3</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="655">    <span class="p">)</span>
</span><span data-line="656">    <span class="n">sh_8_14</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="657">        <span class="o">-</span><span class="mf">0.0883883476483179</span> <span class="o">*</span> <span class="n">sh_7_0</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="658">        <span class="o">+</span> <span class="mf">0.843171097702002</span> <span class="o">*</span> <span class="n">sh_7_12</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="659">        <span class="o">+</span> <span class="mf">0.661437827766147</span> <span class="o">*</span> <span class="n">sh_7_13</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="660">        <span class="o">-</span> <span class="mf">0.088388347648319</span> <span class="o">*</span> <span class="n">sh_7_14</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="661">        <span class="o">-</span> <span class="mf">0.843171097702002</span> <span class="o">*</span> <span class="n">sh_7_2</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="662">    <span class="p">)</span>
</span><span data-line="663">    <span class="n">sh_8_15</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="664">        <span class="o">-</span><span class="mf">0.90571104663684</span> <span class="o">*</span> <span class="n">sh_7_1</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="665">        <span class="o">+</span> <span class="mf">0.90571104663684</span> <span class="o">*</span> <span class="n">sh_7_13</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="666">        <span class="o">+</span> <span class="mf">0.484122918275927</span> <span class="o">*</span> <span class="n">sh_7_14</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="667">    <span class="p">)</span>
</span><span data-line="668">    <span class="n">sh_8_16</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.968245836551853</span> <span class="o">*</span> <span class="n">sh_7_0</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.968245836551855</span> <span class="o">*</span> <span class="n">sh_7_14</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="669">    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span data-line="670">        <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
</span><span data-line="671">            <span class="p">[</span>
</span><span data-line="672">                <span class="n">sh_8_0</span><span class="p">,</span>
</span><span data-line="673">                <span class="n">sh_8_1</span><span class="p">,</span>
</span><span data-line="674">                <span class="n">sh_8_2</span><span class="p">,</span>
</span><span data-line="675">                <span class="n">sh_8_3</span><span class="p">,</span>
</span><span data-line="676">                <span class="n">sh_8_4</span><span class="p">,</span>
</span><span data-line="677">                <span class="n">sh_8_5</span><span class="p">,</span>
</span><span data-line="678">                <span class="n">sh_8_6</span><span class="p">,</span>
</span><span data-line="679">                <span class="n">sh_8_7</span><span class="p">,</span>
</span><span data-line="680">                <span class="n">sh_8_8</span><span class="p">,</span>
</span><span data-line="681">                <span class="n">sh_8_9</span><span class="p">,</span>
</span><span data-line="682">                <span class="n">sh_8_10</span><span class="p">,</span>
</span><span data-line="683">                <span class="n">sh_8_11</span><span class="p">,</span>
</span><span data-line="684">                <span class="n">sh_8_12</span><span class="p">,</span>
</span><span data-line="685">                <span class="n">sh_8_13</span><span class="p">,</span>
</span><span data-line="686">                <span class="n">sh_8_14</span><span class="p">,</span>
</span><span data-line="687">                <span class="n">sh_8_15</span><span class="p">,</span>
</span><span data-line="688">                <span class="n">sh_8_16</span><span class="p">,</span>
</span><span data-line="689">            <span class="p">],</span>
</span><span data-line="690">            <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
</span><span data-line="691">        <span class="p">)</span>
</span><span data-line="692">    <span class="p">)</span>
</span><span data-line="693">    <span class="k">if</span> <span class="n">lmax</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
</span><span data-line="694">        <span class="k">return</span> <span class="n">out</span>
</span><span data-line="695">
</span><span data-line="696">    <span class="n">sh_9_0</span> <span class="o">=</span> <span class="mf">0.97182531580755</span> <span class="o">*</span> <span class="n">sh_8_0</span> <span class="o">*</span> <span class="n">z</span> <span class="o">+</span> <span class="mf">0.971825315807551</span> <span class="o">*</span> <span class="n">sh_8_16</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="697">    <span class="n">sh_9_1</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="698">        <span class="mf">0.458122847290851</span> <span class="o">*</span> <span class="n">sh_8_0</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="699">        <span class="o">+</span> <span class="mf">0.916245694581702</span> <span class="o">*</span> <span class="n">sh_8_1</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="700">        <span class="o">+</span> <span class="mf">0.916245694581702</span> <span class="o">*</span> <span class="n">sh_8_15</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="701">    <span class="p">)</span>
</span><span data-line="702">    <span class="n">sh_9_2</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="703">        <span class="o">-</span><span class="mf">0.078567420131839</span> <span class="o">*</span> <span class="n">sh_8_0</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="704">        <span class="o">+</span> <span class="mf">0.62853936105471</span> <span class="o">*</span> <span class="n">sh_8_1</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="705">        <span class="o">+</span> <span class="mf">0.86066296582387</span> <span class="o">*</span> <span class="n">sh_8_14</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="706">        <span class="o">+</span> <span class="mf">0.0785674201318385</span> <span class="o">*</span> <span class="n">sh_8_16</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="707">        <span class="o">+</span> <span class="mf">0.860662965823871</span> <span class="o">*</span> <span class="n">sh_8_2</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="708">    <span class="p">)</span>
</span><span data-line="709">    <span class="n">sh_9_3</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="710">        <span class="o">-</span><span class="mf">0.136082763487955</span> <span class="o">*</span> <span class="n">sh_8_1</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="711">        <span class="o">+</span> <span class="mf">0.805076485899413</span> <span class="o">*</span> <span class="n">sh_8_13</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="712">        <span class="o">+</span> <span class="mf">0.136082763487954</span> <span class="o">*</span> <span class="n">sh_8_15</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="713">        <span class="o">+</span> <span class="mf">0.74535599249993</span> <span class="o">*</span> <span class="n">sh_8_2</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="714">        <span class="o">+</span> <span class="mf">0.805076485899413</span> <span class="o">*</span> <span class="n">sh_8_3</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="715">    <span class="p">)</span>
</span><span data-line="716">    <span class="n">sh_9_4</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="717">        <span class="mf">0.749485420179558</span> <span class="o">*</span> <span class="n">sh_8_12</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="718">        <span class="o">+</span> <span class="mf">0.192450089729875</span> <span class="o">*</span> <span class="n">sh_8_14</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="719">        <span class="o">-</span> <span class="mf">0.192450089729876</span> <span class="o">*</span> <span class="n">sh_8_2</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="720">        <span class="o">+</span> <span class="mf">0.831479419283099</span> <span class="o">*</span> <span class="n">sh_8_3</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="721">        <span class="o">+</span> <span class="mf">0.749485420179558</span> <span class="o">*</span> <span class="n">sh_8_4</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="722">    <span class="p">)</span>
</span><span data-line="723">    <span class="n">sh_9_5</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="724">        <span class="mf">0.693888666488711</span> <span class="o">*</span> <span class="n">sh_8_11</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="725">        <span class="o">+</span> <span class="mf">0.248451997499977</span> <span class="o">*</span> <span class="n">sh_8_13</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="726">        <span class="o">-</span> <span class="mf">0.248451997499976</span> <span class="o">*</span> <span class="n">sh_8_3</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="727">        <span class="o">+</span> <span class="mf">0.895806416477617</span> <span class="o">*</span> <span class="n">sh_8_4</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="728">        <span class="o">+</span> <span class="mf">0.69388866648871</span> <span class="o">*</span> <span class="n">sh_8_5</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="729">    <span class="p">)</span>
</span><span data-line="730">    <span class="n">sh_9_6</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="731">        <span class="mf">0.638284738504225</span> <span class="o">*</span> <span class="n">sh_8_10</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="732">        <span class="o">+</span> <span class="mf">0.304290309725092</span> <span class="o">*</span> <span class="n">sh_8_12</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="733">        <span class="o">-</span> <span class="mf">0.304290309725092</span> <span class="o">*</span> <span class="n">sh_8_4</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="734">        <span class="o">+</span> <span class="mf">0.942809041582063</span> <span class="o">*</span> <span class="n">sh_8_5</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="735">        <span class="o">+</span> <span class="mf">0.638284738504225</span> <span class="o">*</span> <span class="n">sh_8_6</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="736">    <span class="p">)</span>
</span><span data-line="737">    <span class="n">sh_9_7</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="738">        <span class="mf">0.360041149911548</span> <span class="o">*</span> <span class="n">sh_8_11</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="739">        <span class="o">-</span> <span class="mf">0.360041149911548</span> <span class="o">*</span> <span class="n">sh_8_5</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="740">        <span class="o">+</span> <span class="mf">0.974996043043569</span> <span class="o">*</span> <span class="n">sh_8_6</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="741">        <span class="o">+</span> <span class="mf">0.582671582316751</span> <span class="o">*</span> <span class="n">sh_8_7</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="742">        <span class="o">+</span> <span class="mf">0.582671582316751</span> <span class="o">*</span> <span class="n">sh_8_9</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="743">    <span class="p">)</span>
</span><span data-line="744">    <span class="n">sh_9_8</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="745">        <span class="mf">0.415739709641549</span> <span class="o">*</span> <span class="n">sh_8_10</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="746">        <span class="o">-</span> <span class="mf">0.415739709641549</span> <span class="o">*</span> <span class="n">sh_8_6</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="747">        <span class="o">+</span> <span class="mf">0.993807989999906</span> <span class="o">*</span> <span class="n">sh_8_7</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="748">        <span class="o">+</span> <span class="mf">0.74535599249993</span> <span class="o">*</span> <span class="n">sh_8_8</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="749">    <span class="p">)</span>
</span><span data-line="750">    <span class="n">sh_9_9</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="751">        <span class="o">-</span><span class="mf">0.66666666666666666667</span> <span class="o">*</span> <span class="n">sh_8_7</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="752">        <span class="o">+</span> <span class="n">sh_8_8</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="753">        <span class="o">-</span> <span class="mf">0.66666666666666666667</span> <span class="o">*</span> <span class="n">sh_8_9</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="754">    <span class="p">)</span>
</span><span data-line="755">    <span class="n">sh_9_10</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="756">        <span class="o">-</span><span class="mf">0.415739709641549</span> <span class="o">*</span> <span class="n">sh_8_10</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="757">        <span class="o">-</span> <span class="mf">0.415739709641549</span> <span class="o">*</span> <span class="n">sh_8_6</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="758">        <span class="o">+</span> <span class="mf">0.74535599249993</span> <span class="o">*</span> <span class="n">sh_8_8</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="759">        <span class="o">+</span> <span class="mf">0.993807989999906</span> <span class="o">*</span> <span class="n">sh_8_9</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="760">    <span class="p">)</span>
</span><span data-line="761">    <span class="n">sh_9_11</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="762">        <span class="mf">0.974996043043568</span> <span class="o">*</span> <span class="n">sh_8_10</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="763">        <span class="o">-</span> <span class="mf">0.360041149911547</span> <span class="o">*</span> <span class="n">sh_8_11</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="764">        <span class="o">-</span> <span class="mf">0.360041149911548</span> <span class="o">*</span> <span class="n">sh_8_5</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="765">        <span class="o">-</span> <span class="mf">0.582671582316751</span> <span class="o">*</span> <span class="n">sh_8_7</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="766">        <span class="o">+</span> <span class="mf">0.582671582316751</span> <span class="o">*</span> <span class="n">sh_8_9</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="767">    <span class="p">)</span>
</span><span data-line="768">    <span class="n">sh_9_12</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="769">        <span class="mf">0.638284738504225</span> <span class="o">*</span> <span class="n">sh_8_10</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="770">        <span class="o">+</span> <span class="mf">0.942809041582063</span> <span class="o">*</span> <span class="n">sh_8_11</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="771">        <span class="o">-</span> <span class="mf">0.304290309725092</span> <span class="o">*</span> <span class="n">sh_8_12</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="772">        <span class="o">-</span> <span class="mf">0.304290309725092</span> <span class="o">*</span> <span class="n">sh_8_4</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="773">        <span class="o">-</span> <span class="mf">0.638284738504225</span> <span class="o">*</span> <span class="n">sh_8_6</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="774">    <span class="p">)</span>
</span><span data-line="775">    <span class="n">sh_9_13</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="776">        <span class="mf">0.693888666488711</span> <span class="o">*</span> <span class="n">sh_8_11</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="777">        <span class="o">+</span> <span class="mf">0.895806416477617</span> <span class="o">*</span> <span class="n">sh_8_12</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="778">        <span class="o">-</span> <span class="mf">0.248451997499977</span> <span class="o">*</span> <span class="n">sh_8_13</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="779">        <span class="o">-</span> <span class="mf">0.248451997499977</span> <span class="o">*</span> <span class="n">sh_8_3</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="780">        <span class="o">-</span> <span class="mf">0.693888666488711</span> <span class="o">*</span> <span class="n">sh_8_5</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="781">    <span class="p">)</span>
</span><span data-line="782">    <span class="n">sh_9_14</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="783">        <span class="mf">0.749485420179558</span> <span class="o">*</span> <span class="n">sh_8_12</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="784">        <span class="o">+</span> <span class="mf">0.831479419283098</span> <span class="o">*</span> <span class="n">sh_8_13</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="785">        <span class="o">-</span> <span class="mf">0.192450089729875</span> <span class="o">*</span> <span class="n">sh_8_14</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="786">        <span class="o">-</span> <span class="mf">0.192450089729875</span> <span class="o">*</span> <span class="n">sh_8_2</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="787">        <span class="o">-</span> <span class="mf">0.749485420179558</span> <span class="o">*</span> <span class="n">sh_8_4</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="788">    <span class="p">)</span>
</span><span data-line="789">    <span class="n">sh_9_15</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="790">        <span class="o">-</span><span class="mf">0.136082763487954</span> <span class="o">*</span> <span class="n">sh_8_1</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="791">        <span class="o">+</span> <span class="mf">0.805076485899413</span> <span class="o">*</span> <span class="n">sh_8_13</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="792">        <span class="o">+</span> <span class="mf">0.745355992499929</span> <span class="o">*</span> <span class="n">sh_8_14</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="793">        <span class="o">-</span> <span class="mf">0.136082763487955</span> <span class="o">*</span> <span class="n">sh_8_15</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="794">        <span class="o">-</span> <span class="mf">0.805076485899413</span> <span class="o">*</span> <span class="n">sh_8_3</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="795">    <span class="p">)</span>
</span><span data-line="796">    <span class="n">sh_9_16</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="797">        <span class="o">-</span><span class="mf">0.0785674201318389</span> <span class="o">*</span> <span class="n">sh_8_0</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="798">        <span class="o">+</span> <span class="mf">0.86066296582387</span> <span class="o">*</span> <span class="n">sh_8_14</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="799">        <span class="o">+</span> <span class="mf">0.628539361054709</span> <span class="o">*</span> <span class="n">sh_8_15</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="800">        <span class="o">-</span> <span class="mf">0.0785674201318387</span> <span class="o">*</span> <span class="n">sh_8_16</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="801">        <span class="o">-</span> <span class="mf">0.860662965823871</span> <span class="o">*</span> <span class="n">sh_8_2</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="802">    <span class="p">)</span>
</span><span data-line="803">    <span class="n">sh_9_17</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="804">        <span class="o">-</span><span class="mf">0.9162456945817</span> <span class="o">*</span> <span class="n">sh_8_1</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="805">        <span class="o">+</span> <span class="mf">0.916245694581702</span> <span class="o">*</span> <span class="n">sh_8_15</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="806">        <span class="o">+</span> <span class="mf">0.458122847290851</span> <span class="o">*</span> <span class="n">sh_8_16</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="807">    <span class="p">)</span>
</span><span data-line="808">    <span class="n">sh_9_18</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.97182531580755</span> <span class="o">*</span> <span class="n">sh_8_0</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.97182531580755</span> <span class="o">*</span> <span class="n">sh_8_16</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="809">    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span data-line="810">        <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
</span><span data-line="811">            <span class="p">[</span>
</span><span data-line="812">                <span class="n">sh_9_0</span><span class="p">,</span>
</span><span data-line="813">                <span class="n">sh_9_1</span><span class="p">,</span>
</span><span data-line="814">                <span class="n">sh_9_2</span><span class="p">,</span>
</span><span data-line="815">                <span class="n">sh_9_3</span><span class="p">,</span>
</span><span data-line="816">                <span class="n">sh_9_4</span><span class="p">,</span>
</span><span data-line="817">                <span class="n">sh_9_5</span><span class="p">,</span>
</span><span data-line="818">                <span class="n">sh_9_6</span><span class="p">,</span>
</span><span data-line="819">                <span class="n">sh_9_7</span><span class="p">,</span>
</span><span data-line="820">                <span class="n">sh_9_8</span><span class="p">,</span>
</span><span data-line="821">                <span class="n">sh_9_9</span><span class="p">,</span>
</span><span data-line="822">                <span class="n">sh_9_10</span><span class="p">,</span>
</span><span data-line="823">                <span class="n">sh_9_11</span><span class="p">,</span>
</span><span data-line="824">                <span class="n">sh_9_12</span><span class="p">,</span>
</span><span data-line="825">                <span class="n">sh_9_13</span><span class="p">,</span>
</span><span data-line="826">                <span class="n">sh_9_14</span><span class="p">,</span>
</span><span data-line="827">                <span class="n">sh_9_15</span><span class="p">,</span>
</span><span data-line="828">                <span class="n">sh_9_16</span><span class="p">,</span>
</span><span data-line="829">                <span class="n">sh_9_17</span><span class="p">,</span>
</span><span data-line="830">                <span class="n">sh_9_18</span><span class="p">,</span>
</span><span data-line="831">            <span class="p">],</span>
</span><span data-line="832">            <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
</span><span data-line="833">        <span class="p">)</span>
</span><span data-line="834">    <span class="p">)</span>
</span><span data-line="835">    <span class="k">if</span> <span class="n">lmax</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
</span><span data-line="836">        <span class="k">return</span> <span class="n">out</span>
</span><span data-line="837">
</span><span data-line="838">    <span class="n">sh_10_0</span> <span class="o">=</span> <span class="mf">0.974679434480897</span> <span class="o">*</span> <span class="n">sh_9_0</span> <span class="o">*</span> <span class="n">z</span> <span class="o">+</span> <span class="mf">0.974679434480897</span> <span class="o">*</span> <span class="n">sh_9_18</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="839">    <span class="n">sh_10_1</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="840">        <span class="mf">0.435889894354067</span> <span class="o">*</span> <span class="n">sh_9_0</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="841">        <span class="o">+</span> <span class="mf">0.924662100445347</span> <span class="o">*</span> <span class="n">sh_9_1</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="842">        <span class="o">+</span> <span class="mf">0.924662100445347</span> <span class="o">*</span> <span class="n">sh_9_17</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="843">    <span class="p">)</span>
</span><span data-line="844">    <span class="n">sh_10_2</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="845">        <span class="o">-</span><span class="mf">0.0707106781186546</span> <span class="o">*</span> <span class="n">sh_9_0</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="846">        <span class="o">+</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">sh_9_1</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="847">        <span class="o">+</span> <span class="mf">0.874642784226796</span> <span class="o">*</span> <span class="n">sh_9_16</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="848">        <span class="o">+</span> <span class="mf">0.070710678118655</span> <span class="o">*</span> <span class="n">sh_9_18</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="849">        <span class="o">+</span> <span class="mf">0.874642784226795</span> <span class="o">*</span> <span class="n">sh_9_2</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="850">    <span class="p">)</span>
</span><span data-line="851">    <span class="n">sh_10_3</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="852">        <span class="o">-</span><span class="mf">0.122474487139159</span> <span class="o">*</span> <span class="n">sh_9_1</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="853">        <span class="o">+</span> <span class="mf">0.824621125123533</span> <span class="o">*</span> <span class="n">sh_9_15</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="854">        <span class="o">+</span> <span class="mf">0.122474487139159</span> <span class="o">*</span> <span class="n">sh_9_17</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="855">        <span class="o">+</span> <span class="mf">0.714142842854285</span> <span class="o">*</span> <span class="n">sh_9_2</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="856">        <span class="o">+</span> <span class="mf">0.824621125123533</span> <span class="o">*</span> <span class="n">sh_9_3</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="857">    <span class="p">)</span>
</span><span data-line="858">    <span class="n">sh_10_4</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="859">        <span class="mf">0.774596669241484</span> <span class="o">*</span> <span class="n">sh_9_14</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="860">        <span class="o">+</span> <span class="mf">0.173205080756887</span> <span class="o">*</span> <span class="n">sh_9_16</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="861">        <span class="o">-</span> <span class="mf">0.173205080756888</span> <span class="o">*</span> <span class="n">sh_9_2</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="862">        <span class="o">+</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">sh_9_3</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="863">        <span class="o">+</span> <span class="mf">0.774596669241483</span> <span class="o">*</span> <span class="n">sh_9_4</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="864">    <span class="p">)</span>
</span><span data-line="865">    <span class="n">sh_10_5</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="866">        <span class="mf">0.724568837309472</span> <span class="o">*</span> <span class="n">sh_9_13</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="867">        <span class="o">+</span> <span class="mf">0.223606797749979</span> <span class="o">*</span> <span class="n">sh_9_15</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="868">        <span class="o">-</span> <span class="mf">0.223606797749979</span> <span class="o">*</span> <span class="n">sh_9_3</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="869">        <span class="o">+</span> <span class="mf">0.866025403784438</span> <span class="o">*</span> <span class="n">sh_9_4</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="870">        <span class="o">+</span> <span class="mf">0.724568837309472</span> <span class="o">*</span> <span class="n">sh_9_5</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="871">    <span class="p">)</span>
</span><span data-line="872">    <span class="n">sh_10_6</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="873">        <span class="mf">0.674536878161602</span> <span class="o">*</span> <span class="n">sh_9_12</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="874">        <span class="o">+</span> <span class="mf">0.273861278752583</span> <span class="o">*</span> <span class="n">sh_9_14</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="875">        <span class="o">-</span> <span class="mf">0.273861278752583</span> <span class="o">*</span> <span class="n">sh_9_4</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="876">        <span class="o">+</span> <span class="mf">0.916515138991168</span> <span class="o">*</span> <span class="n">sh_9_5</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="877">        <span class="o">+</span> <span class="mf">0.674536878161602</span> <span class="o">*</span> <span class="n">sh_9_6</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="878">    <span class="p">)</span>
</span><span data-line="879">    <span class="n">sh_10_7</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="880">        <span class="mf">0.62449979983984</span> <span class="o">*</span> <span class="n">sh_9_11</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="881">        <span class="o">+</span> <span class="mf">0.324037034920393</span> <span class="o">*</span> <span class="n">sh_9_13</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="882">        <span class="o">-</span> <span class="mf">0.324037034920393</span> <span class="o">*</span> <span class="n">sh_9_5</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="883">        <span class="o">+</span> <span class="mf">0.953939201416946</span> <span class="o">*</span> <span class="n">sh_9_6</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="884">        <span class="o">+</span> <span class="mf">0.62449979983984</span> <span class="o">*</span> <span class="n">sh_9_7</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="885">    <span class="p">)</span>
</span><span data-line="886">    <span class="n">sh_10_8</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="887">        <span class="mf">0.574456264653803</span> <span class="o">*</span> <span class="n">sh_9_10</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="888">        <span class="o">+</span> <span class="mf">0.374165738677394</span> <span class="o">*</span> <span class="n">sh_9_12</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="889">        <span class="o">-</span> <span class="mf">0.374165738677394</span> <span class="o">*</span> <span class="n">sh_9_6</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="890">        <span class="o">+</span> <span class="mf">0.979795897113272</span> <span class="o">*</span> <span class="n">sh_9_7</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="891">        <span class="o">+</span> <span class="mf">0.574456264653803</span> <span class="o">*</span> <span class="n">sh_9_8</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="892">    <span class="p">)</span>
</span><span data-line="893">    <span class="n">sh_10_9</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="894">        <span class="mf">0.424264068711928</span> <span class="o">*</span> <span class="n">sh_9_11</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="895">        <span class="o">-</span> <span class="mf">0.424264068711929</span> <span class="o">*</span> <span class="n">sh_9_7</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="896">        <span class="o">+</span> <span class="mf">0.99498743710662</span> <span class="o">*</span> <span class="n">sh_9_8</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="897">        <span class="o">+</span> <span class="mf">0.741619848709567</span> <span class="o">*</span> <span class="n">sh_9_9</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="898">    <span class="p">)</span>
</span><span data-line="899">    <span class="n">sh_10_10</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="900">        <span class="o">-</span><span class="mf">0.670820393249937</span> <span class="o">*</span> <span class="n">sh_9_10</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="901">        <span class="o">-</span> <span class="mf">0.670820393249937</span> <span class="o">*</span> <span class="n">sh_9_8</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="902">        <span class="o">+</span> <span class="n">sh_9_9</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="903">    <span class="p">)</span>
</span><span data-line="904">    <span class="n">sh_10_11</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="905">        <span class="mf">0.99498743710662</span> <span class="o">*</span> <span class="n">sh_9_10</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="906">        <span class="o">-</span> <span class="mf">0.424264068711929</span> <span class="o">*</span> <span class="n">sh_9_11</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="907">        <span class="o">-</span> <span class="mf">0.424264068711929</span> <span class="o">*</span> <span class="n">sh_9_7</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="908">        <span class="o">+</span> <span class="mf">0.741619848709567</span> <span class="o">*</span> <span class="n">sh_9_9</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="909">    <span class="p">)</span>
</span><span data-line="910">    <span class="n">sh_10_12</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="911">        <span class="mf">0.574456264653803</span> <span class="o">*</span> <span class="n">sh_9_10</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="912">        <span class="o">+</span> <span class="mf">0.979795897113272</span> <span class="o">*</span> <span class="n">sh_9_11</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="913">        <span class="o">-</span> <span class="mf">0.374165738677395</span> <span class="o">*</span> <span class="n">sh_9_12</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="914">        <span class="o">-</span> <span class="mf">0.374165738677394</span> <span class="o">*</span> <span class="n">sh_9_6</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="915">        <span class="o">-</span> <span class="mf">0.574456264653803</span> <span class="o">*</span> <span class="n">sh_9_8</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="916">    <span class="p">)</span>
</span><span data-line="917">    <span class="n">sh_10_13</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="918">        <span class="mf">0.62449979983984</span> <span class="o">*</span> <span class="n">sh_9_11</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="919">        <span class="o">+</span> <span class="mf">0.953939201416946</span> <span class="o">*</span> <span class="n">sh_9_12</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="920">        <span class="o">-</span> <span class="mf">0.324037034920393</span> <span class="o">*</span> <span class="n">sh_9_13</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="921">        <span class="o">-</span> <span class="mf">0.324037034920393</span> <span class="o">*</span> <span class="n">sh_9_5</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="922">        <span class="o">-</span> <span class="mf">0.62449979983984</span> <span class="o">*</span> <span class="n">sh_9_7</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="923">    <span class="p">)</span>
</span><span data-line="924">    <span class="n">sh_10_14</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="925">        <span class="mf">0.674536878161602</span> <span class="o">*</span> <span class="n">sh_9_12</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="926">        <span class="o">+</span> <span class="mf">0.916515138991168</span> <span class="o">*</span> <span class="n">sh_9_13</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="927">        <span class="o">-</span> <span class="mf">0.273861278752583</span> <span class="o">*</span> <span class="n">sh_9_14</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="928">        <span class="o">-</span> <span class="mf">0.273861278752583</span> <span class="o">*</span> <span class="n">sh_9_4</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="929">        <span class="o">-</span> <span class="mf">0.674536878161603</span> <span class="o">*</span> <span class="n">sh_9_6</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="930">    <span class="p">)</span>
</span><span data-line="931">    <span class="n">sh_10_15</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="932">        <span class="mf">0.724568837309472</span> <span class="o">*</span> <span class="n">sh_9_13</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="933">        <span class="o">+</span> <span class="mf">0.866025403784439</span> <span class="o">*</span> <span class="n">sh_9_14</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="934">        <span class="o">-</span> <span class="mf">0.223606797749979</span> <span class="o">*</span> <span class="n">sh_9_15</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="935">        <span class="o">-</span> <span class="mf">0.223606797749979</span> <span class="o">*</span> <span class="n">sh_9_3</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="936">        <span class="o">-</span> <span class="mf">0.724568837309472</span> <span class="o">*</span> <span class="n">sh_9_5</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="937">    <span class="p">)</span>
</span><span data-line="938">    <span class="n">sh_10_16</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="939">        <span class="mf">0.774596669241484</span> <span class="o">*</span> <span class="n">sh_9_14</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="940">        <span class="o">+</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">sh_9_15</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="941">        <span class="o">-</span> <span class="mf">0.173205080756888</span> <span class="o">*</span> <span class="n">sh_9_16</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="942">        <span class="o">-</span> <span class="mf">0.173205080756887</span> <span class="o">*</span> <span class="n">sh_9_2</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="943">        <span class="o">-</span> <span class="mf">0.774596669241484</span> <span class="o">*</span> <span class="n">sh_9_4</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="944">    <span class="p">)</span>
</span><span data-line="945">    <span class="n">sh_10_17</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="946">        <span class="o">-</span><span class="mf">0.12247448713916</span> <span class="o">*</span> <span class="n">sh_9_1</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="947">        <span class="o">+</span> <span class="mf">0.824621125123532</span> <span class="o">*</span> <span class="n">sh_9_15</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="948">        <span class="o">+</span> <span class="mf">0.714142842854285</span> <span class="o">*</span> <span class="n">sh_9_16</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="949">        <span class="o">-</span> <span class="mf">0.122474487139158</span> <span class="o">*</span> <span class="n">sh_9_17</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="950">        <span class="o">-</span> <span class="mf">0.824621125123533</span> <span class="o">*</span> <span class="n">sh_9_3</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="951">    <span class="p">)</span>
</span><span data-line="952">    <span class="n">sh_10_18</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="953">        <span class="o">-</span><span class="mf">0.0707106781186548</span> <span class="o">*</span> <span class="n">sh_9_0</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="954">        <span class="o">+</span> <span class="mf">0.874642784226796</span> <span class="o">*</span> <span class="n">sh_9_16</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="955">        <span class="o">+</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">sh_9_17</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="956">        <span class="o">-</span> <span class="mf">0.0707106781186546</span> <span class="o">*</span> <span class="n">sh_9_18</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="957">        <span class="o">-</span> <span class="mf">0.874642784226796</span> <span class="o">*</span> <span class="n">sh_9_2</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="958">    <span class="p">)</span>
</span><span data-line="959">    <span class="n">sh_10_19</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="960">        <span class="o">-</span><span class="mf">0.924662100445348</span> <span class="o">*</span> <span class="n">sh_9_1</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="961">        <span class="o">+</span> <span class="mf">0.924662100445347</span> <span class="o">*</span> <span class="n">sh_9_17</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="962">        <span class="o">+</span> <span class="mf">0.435889894354068</span> <span class="o">*</span> <span class="n">sh_9_18</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="963">    <span class="p">)</span>
</span><span data-line="964">    <span class="n">sh_10_20</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.974679434480898</span> <span class="o">*</span> <span class="n">sh_9_0</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.974679434480896</span> <span class="o">*</span> <span class="n">sh_9_18</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="965">    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span data-line="966">        <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
</span><span data-line="967">            <span class="p">[</span>
</span><span data-line="968">                <span class="n">sh_10_0</span><span class="p">,</span>
</span><span data-line="969">                <span class="n">sh_10_1</span><span class="p">,</span>
</span><span data-line="970">                <span class="n">sh_10_2</span><span class="p">,</span>
</span><span data-line="971">                <span class="n">sh_10_3</span><span class="p">,</span>
</span><span data-line="972">                <span class="n">sh_10_4</span><span class="p">,</span>
</span><span data-line="973">                <span class="n">sh_10_5</span><span class="p">,</span>
</span><span data-line="974">                <span class="n">sh_10_6</span><span class="p">,</span>
</span><span data-line="975">                <span class="n">sh_10_7</span><span class="p">,</span>
</span><span data-line="976">                <span class="n">sh_10_8</span><span class="p">,</span>
</span><span data-line="977">                <span class="n">sh_10_9</span><span class="p">,</span>
</span><span data-line="978">                <span class="n">sh_10_10</span><span class="p">,</span>
</span><span data-line="979">                <span class="n">sh_10_11</span><span class="p">,</span>
</span><span data-line="980">                <span class="n">sh_10_12</span><span class="p">,</span>
</span><span data-line="981">                <span class="n">sh_10_13</span><span class="p">,</span>
</span><span data-line="982">                <span class="n">sh_10_14</span><span class="p">,</span>
</span><span data-line="983">                <span class="n">sh_10_15</span><span class="p">,</span>
</span><span data-line="984">                <span class="n">sh_10_16</span><span class="p">,</span>
</span><span data-line="985">                <span class="n">sh_10_17</span><span class="p">,</span>
</span><span data-line="986">                <span class="n">sh_10_18</span><span class="p">,</span>
</span><span data-line="987">                <span class="n">sh_10_19</span><span class="p">,</span>
</span><span data-line="988">                <span class="n">sh_10_20</span><span class="p">,</span>
</span><span data-line="989">            <span class="p">],</span>
</span><span data-line="990">            <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
</span><span data-line="991">        <span class="p">)</span>
</span><span data-line="992">    <span class="p">)</span>
</span><span data-line="993">    <span class="k">if</span> <span class="n">lmax</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
</span><span data-line="994">        <span class="k">return</span> <span class="n">out</span>
</span><span data-line="995">
</span><span data-line="996">    <span class="n">sh_11_0</span> <span class="o">=</span> <span class="mf">0.977008420918394</span> <span class="o">*</span> <span class="n">sh_10_0</span> <span class="o">*</span> <span class="n">z</span> <span class="o">+</span> <span class="mf">0.977008420918394</span> <span class="o">*</span> <span class="n">sh_10_20</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="997">    <span class="n">sh_11_1</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="998">        <span class="mf">0.416597790450531</span> <span class="o">*</span> <span class="n">sh_10_0</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="999">        <span class="o">+</span> <span class="mf">0.9315409787236</span> <span class="o">*</span> <span class="n">sh_10_1</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1000">        <span class="o">+</span> <span class="mf">0.931540978723599</span> <span class="o">*</span> <span class="n">sh_10_19</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1001">    <span class="p">)</span>
</span><span data-line="1002">    <span class="n">sh_11_2</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="1003">        <span class="o">-</span><span class="mf">0.0642824346533223</span> <span class="o">*</span> <span class="n">sh_10_0</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1004">        <span class="o">+</span> <span class="mf">0.574959574576069</span> <span class="o">*</span> <span class="n">sh_10_1</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="1005">        <span class="o">+</span> <span class="mf">0.88607221316445</span> <span class="o">*</span> <span class="n">sh_10_18</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1006">        <span class="o">+</span> <span class="mf">0.886072213164452</span> <span class="o">*</span> <span class="n">sh_10_2</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1007">        <span class="o">+</span> <span class="mf">0.0642824346533226</span> <span class="o">*</span> <span class="n">sh_10_20</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1008">    <span class="p">)</span>
</span><span data-line="1009">    <span class="n">sh_11_3</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="1010">        <span class="o">-</span><span class="mf">0.111340442853781</span> <span class="o">*</span> <span class="n">sh_10_1</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1011">        <span class="o">+</span> <span class="mf">0.84060190949577</span> <span class="o">*</span> <span class="n">sh_10_17</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1012">        <span class="o">+</span> <span class="mf">0.111340442853781</span> <span class="o">*</span> <span class="n">sh_10_19</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1013">        <span class="o">+</span> <span class="mf">0.686348585024614</span> <span class="o">*</span> <span class="n">sh_10_2</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="1014">        <span class="o">+</span> <span class="mf">0.840601909495769</span> <span class="o">*</span> <span class="n">sh_10_3</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1015">    <span class="p">)</span>
</span><span data-line="1016">    <span class="n">sh_11_4</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="1017">        <span class="mf">0.795129803842541</span> <span class="o">*</span> <span class="n">sh_10_16</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1018">        <span class="o">+</span> <span class="mf">0.157459164324444</span> <span class="o">*</span> <span class="n">sh_10_18</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1019">        <span class="o">-</span> <span class="mf">0.157459164324443</span> <span class="o">*</span> <span class="n">sh_10_2</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1020">        <span class="o">+</span> <span class="mf">0.771389215839871</span> <span class="o">*</span> <span class="n">sh_10_3</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="1021">        <span class="o">+</span> <span class="mf">0.795129803842541</span> <span class="o">*</span> <span class="n">sh_10_4</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1022">    <span class="p">)</span>
</span><span data-line="1023">    <span class="n">sh_11_5</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="1024">        <span class="mf">0.74965556829412</span> <span class="o">*</span> <span class="n">sh_10_15</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1025">        <span class="o">+</span> <span class="mf">0.203278907045435</span> <span class="o">*</span> <span class="n">sh_10_17</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1026">        <span class="o">-</span> <span class="mf">0.203278907045436</span> <span class="o">*</span> <span class="n">sh_10_3</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1027">        <span class="o">+</span> <span class="mf">0.838140405208444</span> <span class="o">*</span> <span class="n">sh_10_4</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="1028">        <span class="o">+</span> <span class="mf">0.74965556829412</span> <span class="o">*</span> <span class="n">sh_10_5</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1029">    <span class="p">)</span>
</span><span data-line="1030">    <span class="n">sh_11_6</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="1031">        <span class="mf">0.70417879021953</span> <span class="o">*</span> <span class="n">sh_10_14</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1032">        <span class="o">+</span> <span class="mf">0.248964798865985</span> <span class="o">*</span> <span class="n">sh_10_16</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1033">        <span class="o">-</span> <span class="mf">0.248964798865985</span> <span class="o">*</span> <span class="n">sh_10_4</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1034">        <span class="o">+</span> <span class="mf">0.890723542830247</span> <span class="o">*</span> <span class="n">sh_10_5</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="1035">        <span class="o">+</span> <span class="mf">0.704178790219531</span> <span class="o">*</span> <span class="n">sh_10_6</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1036">    <span class="p">)</span>
</span><span data-line="1037">    <span class="n">sh_11_7</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="1038">        <span class="mf">0.658698943008611</span> <span class="o">*</span> <span class="n">sh_10_13</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1039">        <span class="o">+</span> <span class="mf">0.294579122654903</span> <span class="o">*</span> <span class="n">sh_10_15</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1040">        <span class="o">-</span> <span class="mf">0.294579122654903</span> <span class="o">*</span> <span class="n">sh_10_5</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1041">        <span class="o">+</span> <span class="mf">0.9315409787236</span> <span class="o">*</span> <span class="n">sh_10_6</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="1042">        <span class="o">+</span> <span class="mf">0.658698943008611</span> <span class="o">*</span> <span class="n">sh_10_7</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1043">    <span class="p">)</span>
</span><span data-line="1044">    <span class="n">sh_11_8</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="1045">        <span class="mf">0.613215343783275</span> <span class="o">*</span> <span class="n">sh_10_12</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1046">        <span class="o">+</span> <span class="mf">0.340150671524904</span> <span class="o">*</span> <span class="n">sh_10_14</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1047">        <span class="o">-</span> <span class="mf">0.340150671524904</span> <span class="o">*</span> <span class="n">sh_10_6</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1048">        <span class="o">+</span> <span class="mf">0.962091385841669</span> <span class="o">*</span> <span class="n">sh_10_7</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="1049">        <span class="o">+</span> <span class="mf">0.613215343783274</span> <span class="o">*</span> <span class="n">sh_10_8</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1050">    <span class="p">)</span>
</span><span data-line="1051">    <span class="n">sh_11_9</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="1052">        <span class="mf">0.567727090763491</span> <span class="o">*</span> <span class="n">sh_10_11</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1053">        <span class="o">+</span> <span class="mf">0.385694607919935</span> <span class="o">*</span> <span class="n">sh_10_13</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1054">        <span class="o">-</span> <span class="mf">0.385694607919935</span> <span class="o">*</span> <span class="n">sh_10_7</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1055">        <span class="o">+</span> <span class="mf">0.983332166035633</span> <span class="o">*</span> <span class="n">sh_10_8</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="1056">        <span class="o">+</span> <span class="mf">0.56772709076349</span> <span class="o">*</span> <span class="n">sh_10_9</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1057">    <span class="p">)</span>
</span><span data-line="1058">    <span class="n">sh_11_10</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="1059">        <span class="mf">0.738548945875997</span> <span class="o">*</span> <span class="n">sh_10_10</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1060">        <span class="o">+</span> <span class="mf">0.431219680932052</span> <span class="o">*</span> <span class="n">sh_10_12</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1061">        <span class="o">-</span> <span class="mf">0.431219680932052</span> <span class="o">*</span> <span class="n">sh_10_8</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1062">        <span class="o">+</span> <span class="mf">0.995859195463938</span> <span class="o">*</span> <span class="n">sh_10_9</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="1063">    <span class="p">)</span>
</span><span data-line="1064">    <span class="n">sh_11_11</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="1065">        <span class="n">sh_10_10</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="1066">        <span class="o">-</span> <span class="mf">0.674199862463242</span> <span class="o">*</span> <span class="n">sh_10_11</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1067">        <span class="o">-</span> <span class="mf">0.674199862463243</span> <span class="o">*</span> <span class="n">sh_10_9</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1068">    <span class="p">)</span>
</span><span data-line="1069">    <span class="n">sh_11_12</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="1070">        <span class="mf">0.738548945875996</span> <span class="o">*</span> <span class="n">sh_10_10</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1071">        <span class="o">+</span> <span class="mf">0.995859195463939</span> <span class="o">*</span> <span class="n">sh_10_11</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="1072">        <span class="o">-</span> <span class="mf">0.431219680932052</span> <span class="o">*</span> <span class="n">sh_10_12</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1073">        <span class="o">-</span> <span class="mf">0.431219680932053</span> <span class="o">*</span> <span class="n">sh_10_8</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1074">    <span class="p">)</span>
</span><span data-line="1075">    <span class="n">sh_11_13</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="1076">        <span class="mf">0.567727090763491</span> <span class="o">*</span> <span class="n">sh_10_11</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1077">        <span class="o">+</span> <span class="mf">0.983332166035634</span> <span class="o">*</span> <span class="n">sh_10_12</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="1078">        <span class="o">-</span> <span class="mf">0.385694607919935</span> <span class="o">*</span> <span class="n">sh_10_13</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1079">        <span class="o">-</span> <span class="mf">0.385694607919935</span> <span class="o">*</span> <span class="n">sh_10_7</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1080">        <span class="o">-</span> <span class="mf">0.567727090763491</span> <span class="o">*</span> <span class="n">sh_10_9</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1081">    <span class="p">)</span>
</span><span data-line="1082">    <span class="n">sh_11_14</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="1083">        <span class="mf">0.613215343783275</span> <span class="o">*</span> <span class="n">sh_10_12</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1084">        <span class="o">+</span> <span class="mf">0.96209138584167</span> <span class="o">*</span> <span class="n">sh_10_13</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="1085">        <span class="o">-</span> <span class="mf">0.340150671524904</span> <span class="o">*</span> <span class="n">sh_10_14</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1086">        <span class="o">-</span> <span class="mf">0.340150671524904</span> <span class="o">*</span> <span class="n">sh_10_6</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1087">        <span class="o">-</span> <span class="mf">0.613215343783274</span> <span class="o">*</span> <span class="n">sh_10_8</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1088">    <span class="p">)</span>
</span><span data-line="1089">    <span class="n">sh_11_15</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="1090">        <span class="mf">0.658698943008611</span> <span class="o">*</span> <span class="n">sh_10_13</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1091">        <span class="o">+</span> <span class="mf">0.9315409787236</span> <span class="o">*</span> <span class="n">sh_10_14</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="1092">        <span class="o">-</span> <span class="mf">0.294579122654903</span> <span class="o">*</span> <span class="n">sh_10_15</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1093">        <span class="o">-</span> <span class="mf">0.294579122654903</span> <span class="o">*</span> <span class="n">sh_10_5</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1094">        <span class="o">-</span> <span class="mf">0.65869894300861</span> <span class="o">*</span> <span class="n">sh_10_7</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1095">    <span class="p">)</span>
</span><span data-line="1096">    <span class="n">sh_11_16</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="1097">        <span class="mf">0.70417879021953</span> <span class="o">*</span> <span class="n">sh_10_14</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1098">        <span class="o">+</span> <span class="mf">0.890723542830246</span> <span class="o">*</span> <span class="n">sh_10_15</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="1099">        <span class="o">-</span> <span class="mf">0.248964798865985</span> <span class="o">*</span> <span class="n">sh_10_16</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1100">        <span class="o">-</span> <span class="mf">0.248964798865985</span> <span class="o">*</span> <span class="n">sh_10_4</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1101">        <span class="o">-</span> <span class="mf">0.70417879021953</span> <span class="o">*</span> <span class="n">sh_10_6</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1102">    <span class="p">)</span>
</span><span data-line="1103">    <span class="n">sh_11_17</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="1104">        <span class="mf">0.749655568294121</span> <span class="o">*</span> <span class="n">sh_10_15</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1105">        <span class="o">+</span> <span class="mf">0.838140405208444</span> <span class="o">*</span> <span class="n">sh_10_16</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="1106">        <span class="o">-</span> <span class="mf">0.203278907045436</span> <span class="o">*</span> <span class="n">sh_10_17</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1107">        <span class="o">-</span> <span class="mf">0.203278907045435</span> <span class="o">*</span> <span class="n">sh_10_3</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1108">        <span class="o">-</span> <span class="mf">0.749655568294119</span> <span class="o">*</span> <span class="n">sh_10_5</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1109">    <span class="p">)</span>
</span><span data-line="1110">    <span class="n">sh_11_18</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="1111">        <span class="mf">0.79512980384254</span> <span class="o">*</span> <span class="n">sh_10_16</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1112">        <span class="o">+</span> <span class="mf">0.77138921583987</span> <span class="o">*</span> <span class="n">sh_10_17</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="1113">        <span class="o">-</span> <span class="mf">0.157459164324443</span> <span class="o">*</span> <span class="n">sh_10_18</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1114">        <span class="o">-</span> <span class="mf">0.157459164324444</span> <span class="o">*</span> <span class="n">sh_10_2</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1115">        <span class="o">-</span> <span class="mf">0.795129803842541</span> <span class="o">*</span> <span class="n">sh_10_4</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1116">    <span class="p">)</span>
</span><span data-line="1117">    <span class="n">sh_11_19</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="1118">        <span class="o">-</span><span class="mf">0.111340442853782</span> <span class="o">*</span> <span class="n">sh_10_1</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1119">        <span class="o">+</span> <span class="mf">0.84060190949577</span> <span class="o">*</span> <span class="n">sh_10_17</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1120">        <span class="o">+</span> <span class="mf">0.686348585024614</span> <span class="o">*</span> <span class="n">sh_10_18</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="1121">        <span class="o">-</span> <span class="mf">0.111340442853781</span> <span class="o">*</span> <span class="n">sh_10_19</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1122">        <span class="o">-</span> <span class="mf">0.840601909495769</span> <span class="o">*</span> <span class="n">sh_10_3</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1123">    <span class="p">)</span>
</span><span data-line="1124">    <span class="n">sh_11_20</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="1125">        <span class="o">-</span><span class="mf">0.0642824346533226</span> <span class="o">*</span> <span class="n">sh_10_0</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1126">        <span class="o">+</span> <span class="mf">0.886072213164451</span> <span class="o">*</span> <span class="n">sh_10_18</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1127">        <span class="o">+</span> <span class="mf">0.57495957457607</span> <span class="o">*</span> <span class="n">sh_10_19</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="1128">        <span class="o">-</span> <span class="mf">0.886072213164451</span> <span class="o">*</span> <span class="n">sh_10_2</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1129">        <span class="o">-</span> <span class="mf">0.0642824346533228</span> <span class="o">*</span> <span class="n">sh_10_20</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1130">    <span class="p">)</span>
</span><span data-line="1131">    <span class="n">sh_11_21</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="1132">        <span class="o">-</span><span class="mf">0.9315409787236</span> <span class="o">*</span> <span class="n">sh_10_1</span> <span class="o">*</span> <span class="n">x</span>
</span><span data-line="1133">        <span class="o">+</span> <span class="mf">0.931540978723599</span> <span class="o">*</span> <span class="n">sh_10_19</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1134">        <span class="o">+</span> <span class="mf">0.416597790450531</span> <span class="o">*</span> <span class="n">sh_10_20</span> <span class="o">*</span> <span class="n">y</span>
</span><span data-line="1135">    <span class="p">)</span>
</span><span data-line="1136">    <span class="n">sh_11_22</span> <span class="o">=</span> <span class="p">(</span>
</span><span data-line="1137">        <span class="o">-</span><span class="mf">0.977008420918393</span> <span class="o">*</span> <span class="n">sh_10_0</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.977008420918393</span> <span class="o">*</span> <span class="n">sh_10_20</span> <span class="o">*</span> <span class="n">z</span>
</span><span data-line="1138">    <span class="p">)</span>
</span><span data-line="1139">
</span><span data-line="1140">    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span data-line="1141">        <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
</span><span data-line="1142">            <span class="p">[</span>
</span><span data-line="1143">                <span class="n">sh_11_0</span><span class="p">,</span>
</span><span data-line="1144">                <span class="n">sh_11_1</span><span class="p">,</span>
</span><span data-line="1145">                <span class="n">sh_11_2</span><span class="p">,</span>
</span><span data-line="1146">                <span class="n">sh_11_3</span><span class="p">,</span>
</span><span data-line="1147">                <span class="n">sh_11_4</span><span class="p">,</span>
</span><span data-line="1148">                <span class="n">sh_11_5</span><span class="p">,</span>
</span><span data-line="1149">                <span class="n">sh_11_6</span><span class="p">,</span>
</span><span data-line="1150">                <span class="n">sh_11_7</span><span class="p">,</span>
</span><span data-line="1151">                <span class="n">sh_11_8</span><span class="p">,</span>
</span><span data-line="1152">                <span class="n">sh_11_9</span><span class="p">,</span>
</span><span data-line="1153">                <span class="n">sh_11_10</span><span class="p">,</span>
</span><span data-line="1154">                <span class="n">sh_11_11</span><span class="p">,</span>
</span><span data-line="1155">                <span class="n">sh_11_12</span><span class="p">,</span>
</span><span data-line="1156">                <span class="n">sh_11_13</span><span class="p">,</span>
</span><span data-line="1157">                <span class="n">sh_11_14</span><span class="p">,</span>
</span><span data-line="1158">                <span class="n">sh_11_15</span><span class="p">,</span>
</span><span data-line="1159">                <span class="n">sh_11_16</span><span class="p">,</span>
</span><span data-line="1160">                <span class="n">sh_11_17</span><span class="p">,</span>
</span><span data-line="1161">                <span class="n">sh_11_18</span><span class="p">,</span>
</span><span data-line="1162">                <span class="n">sh_11_19</span><span class="p">,</span>
</span><span data-line="1163">                <span class="n">sh_11_20</span><span class="p">,</span>
</span><span data-line="1164">                <span class="n">sh_11_21</span><span class="p">,</span>
</span><span data-line="1165">                <span class="n">sh_11_22</span><span class="p">,</span>
</span><span data-line="1166">            <span class="p">],</span>
</span><span data-line="1167">            <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
</span><span data-line="1168">        <span class="p">)</span>
</span><span data-line="1169">    <span class="p">)</span>
</span><span data-line="1170">
</span><span data-line="1171">    <span class="k">return</span> <span class="n">out</span>
</span><span data-line="1172">
</span><span data-line="1173">
</span><span data-line="1174"><span class="k">def</span><span class="w"> </span><span class="nf">_generate_spherical_harmonics</span><span class="p">(</span><span class="n">lmax</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
</span><span data-line="1175"><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;code used to generate the code above</span>
</span><span data-line="1176">
</span><span data-line="1177"><span class="sd">    based on `wigner_3j`</span>
</span><span data-line="1178"><span class="sd">    &quot;&quot;&quot;</span>
</span><span data-line="1179">    <span class="n">torch</span><span class="o">.</span><span class="n">set_default_dtype</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</span><span data-line="1180">
</span><span data-line="1181">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sh_0_0 = torch.ones(x.shape, dtype=x.dtype, device=x.device)&quot;</span><span class="p">)</span>
</span><span data-line="1182">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;if lmax == 0:&quot;</span><span class="p">)</span>
</span><span data-line="1183">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    return sh_0_0&quot;</span><span class="p">)</span>
</span><span data-line="1184">    <span class="nb">print</span><span class="p">()</span>
</span><span data-line="1185">
</span><span data-line="1186">    <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;y z x&quot;</span><span class="p">)</span>
</span><span data-line="1187">    <span class="n">polynomials</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>
</span><span data-line="1188">    <span class="n">polynormz</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span data-line="1189">
</span><span data-line="1190">    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">lmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span data-line="1191">        <span class="n">names</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sh_</span><span class="si">{</span><span class="n">l</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
</span><span data-line="1192">
</span><span data-line="1193">        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">polynomials</span><span class="p">):</span>
</span><span data-line="1194">            <span class="n">p</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span><span data-line="1195">            <span class="n">p</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">N</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</span><span data-line="1196">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">pycode</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="1197">
</span><span data-line="1198">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;if lmax == </span><span class="si">{</span><span class="n">l</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
</span><span data-line="1199">        <span class="n">u</span> <span class="o">=</span> <span class="s2">&quot;,</span><span class="se">\n</span><span class="s2">        &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
</span><span data-line="1200">            <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sh_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span data-line="1201">            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span data-line="1202">        <span class="p">)</span>
</span><span data-line="1203">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    return torch.stack([</span><span class="se">\n</span><span class="s2">        </span><span class="si">{</span><span class="n">u</span><span class="si">}</span><span class="se">\n</span><span class="s2">    ], dim=-1)&quot;</span><span class="p">)</span>
</span><span data-line="1204">        <span class="nb">print</span><span class="p">()</span>
</span><span data-line="1205">
</span><span data-line="1206">        <span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="n">lmax</span><span class="p">:</span>
</span><span data-line="1207">            <span class="k">break</span>
</span><span data-line="1208">
</span><span data-line="1209">        <span class="n">polynomials</span> <span class="o">=</span> <span class="p">[</span>
</span><span data-line="1210">            <span class="nb">sum</span><span class="p">(</span>
</span><span data-line="1211">                <span class="n">c</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">*</span> <span class="n">v</span> <span class="o">*</span> <span class="n">p</span>
</span><span data-line="1212">                <span class="k">for</span> <span class="n">cj</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cij</span><span class="p">,</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="p">])</span>
</span><span data-line="1213">                <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cj</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
</span><span data-line="1214">            <span class="p">)</span>
</span><span data-line="1215">            <span class="k">for</span> <span class="n">cij</span> <span class="ow">in</span> <span class="n">o3</span><span class="o">.</span><span class="n">wigner_3j</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</span><span data-line="1216">        <span class="p">]</span>
</span><span data-line="1217">
</span><span data-line="1218">        <span class="k">def</span><span class="w"> </span><span class="nf">sub</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">polynormz</span><span class="p">):</span>
</span><span data-line="1219">            <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span data-line="1220">            <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">polynormz</span><span class="p">):</span>
</span><span data-line="1221">                <span class="n">p</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</span><span data-line="1222">            <span class="k">return</span> <span class="n">p</span>
</span><span data-line="1223">
</span><span data-line="1224">        <span class="n">polynormz</span> <span class="o">=</span> <span class="p">[</span><span class="n">sub</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">polynormz</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">polynomials</span><span class="p">]</span>
</span><span data-line="1225">        <span class="n">norm</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">polynormz</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
</span><span data-line="1226">        <span class="n">polynomials</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="o">/</span> <span class="n">norm</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">polynomials</span><span class="p">]</span>
</span><span data-line="1227">        <span class="n">polynormz</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="o">/</span> <span class="n">norm</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">polynormz</span><span class="p">]</span>
</span><span data-line="1228">
</span><span data-line="1229">        <span class="n">polynomials</span> <span class="o">=</span> <span class="p">[</span><span class="n">sympy</span><span class="o">.</span><span class="n">nsimplify</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">polynomials</span><span class="p">]</span>
</span></pre></div>
        </article><button class="back-to-top" type="button">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
  </svg>
  <span>Back to top</span>
</button><div class="navigation flex print:hidden"></div></div>
    </div>
  </main>
</div>
<footer class="sy-foot">
  <div class="sy-foot-inner sy-container mx-auto">
    <div class="sy-foot-reserved md:flex justify-between items-center">
      <div class="sy-foot-copyright"><p>2026, Clementi Group</p>
  
  <p>
    Made with
    
    <a href="https://www.sphinx-doc.org/">Sphinx</a> and
    
    <a href="https://shibuya.lepture.com">Shibuya theme</a>.
  </p>
</div>
      <div class="sy-foot-socials"></div>
    </div>
  </div>
</footer>
      <script src="../../../../_static/documentation_options.js?v=360bc84d"></script>
      <script src="../../../../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script src="../../../../_static/shibuya.js?v=cac61aee"></script></body>
</html>