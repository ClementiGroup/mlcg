ckpt_path: last
data:
  h5_file_path: ./combined_demo_dataset.h5
  loading_options:
    hdf_key_mapping:
      coords: cg_coords
      embeds: attrs:cg_embeds
      forces: cg_delta_forces
  partition_options: ./partition_demo.yaml
model:
  loss:
    class_path: mlcg.nn.Loss
    init_args:
      losses:
      - class_path: mlcg.nn.ForceMSE
        init_args:
          force_kwd: forces
  model:
    class_path: mlcg.nn.GradientsOut
    init_args:
      model:
        class_path: mlcg.nn.schnet.StandardSchNet
        init_args:
          activation:
            class_path: torch.nn.Tanh
            init_args: {}
          aggr: add
          cutoff:
            class_path: mlcg.nn.CosineCutoff
            init_args:
              cutoff_lower: 0
              cutoff_upper: 15
          embedding_size: 25
          hidden_channels: 128
          max_num_neighbors: 1000
          num_filters: 128
          num_interactions: 4
          output_hidden_layer_widths:
          - 128
          - 64
          rbf_layer:
            class_path: mlcg.nn.ExpNormalBasis
            init_args:
              cutoff: 15
              num_rbf: 64
              trainable: false
      targets: forces
optimizer:
  class_path: torch.optim.Adam
  init_args:
    lr: 0.0001
    weight_decay: 0
seed_everything: 678549326
trainer:
  accelerator: gpu
  accumulate_grad_batches: 4
  benchmark: false
  callbacks:
  - class_path: pytorch_lightning.callbacks.LearningRateMonitor
    init_args:
      log_momentum: false
      logging_interval: epoch
  - class_path: mlcg.pl.OffsetCheckpoint
    init_args:
      dirpath: default_root_dir
      every_n_epochs: 1
      filename: '{epoch}-{validation_loss:.4f}'
      monitor: validation_loss
      save_last: true
      save_top_k: -1
      start_epoch: 0
  check_val_every_n_epoch: 1
  default_root_dir: .
  detect_anomaly: false
  deterministic: false
  enable_checkpointing: true
  enable_model_summary: false
  enable_progress_bar: true
  fast_dev_run: false
  gradient_clip_algorithm: norm
  gradient_clip_val: 0
  log_every_n_steps: 100
  logger:
  - class_path: pytorch_lightning.loggers.TensorBoardLogger
    init_args:
      name: tensorboard
      save_dir: default_root_dir
      version: ''
  max_epochs: 150
  num_nodes: 1
  precision: 32
